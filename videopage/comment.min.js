var _____WB$wombat$assign$function_____ = function(name) {return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name)) || self[name]; };
if (!self.__WB_pmw) { self.__WB_pmw = function(obj) { this.__WB_source = obj; return this; } }
{
  let window = _____WB$wombat$assign$function_____("window");
  let self = _____WB$wombat$assign$function_____("self");
  let document = _____WB$wombat$assign$function_____("document");
  let location = _____WB$wombat$assign$function_____("location");
  let top = _____WB$wombat$assign$function_____("top");
  let parent = _____WB$wombat$assign$function_____("parent");
  let frames = _____WB$wombat$assign$function_____("frames");
  let opener = _____WB$wombat$assign$function_____("opener");

!function(i){var o={};function a(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=i,a.c=o,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(i,o,function(t){return e[t]}.bind(null,o));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=3)}([function(t,e){var s={uncurryThis:function(t){return function(){return t.call.apply(t,arguments)}},curryThis:function(e){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),e.apply(null,t)}},bindFn:function(t,e){var i=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,i.concat(Array.prototype.slice.call(arguments)))}},extend:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function o(){}return o.prototype=e.prototype,t.prototype=new o,(t.prototype.constructor=t).__super__=e.prototype,t},mixin:function(t){for(var e=Array.prototype.slice.call(arguments,1),i=0;i<e.length;i++){var o,a=e[i];for(o in a)t[o]||(t[o]=a[o])}},distinctArray:function(t){for(var e,i=[],o={},a=0;a<t.length;a++){var s=(e=t[a])+":"+typeof e;o[s]||(i.push(e),o[s]=!0)}return i},browser:{version:function(){var t=navigator.userAgent;navigator.appVersion;return{trident:/Trident/i.test(t),presto:/Presto/i.test(t),webKit:/AppleWebKit/i.test(t),gecko:/Gecko/i.test(t)&&!/KHTML/i.test(t),mobile:/AppleWebKit.*Mobile.*/i.test(t),ios:/\(i[^;]+;( U;)? CPU.+Mac OS X/i.test(t),android:/Android/i.test(t)||/Linux/i.test(t),windowsphone:/Windows Phone/i.test(t),iPhone:/iPhone/i.test(t),iPad:/iPad/i.test(t),MicroMessenger:/MicroMessenger/i.test(t),webApp:!/Safari/i.test(t),edge:/edge/i.test(t),weibo:/Weibo/i.test(t),uc:/UCBrowser/i.test(t),qq:/MQQBrowser/i.test(t),baidu:/Baidu/i.test(t)}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase(),lteIE:function(t){return $.browser.msie&&parseInt($.browser.version)<=t}},cookie:{get:function(t){var e=""+document.cookie,i=e.indexOf(t+"=");if(-1==i||""==t)return"";var o=e.indexOf(";",i);return-1==o&&(o=e.length),unescape(e.substring(i+t.length+1,o))},set:function(t,e,i){i=void 0!==i?i:365;var o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3),document.cookie=t+"="+escape(e)+";expires="+o.toGMTString()+"; path=/; domain=.bilibili.com"},delete:function(t){this.set(t,"",-1)}},readFromLocal:function(t){return this.localStorage._support?localStorage.getItem(t):this.cookie.get(t)},saveToLocal:function(t,e,i){return this.localStorage._support?localStorage.setItem(t,e):this.cookie.set(t,e,i)},localStorage:{_support:!(!window.localStorage||"object"!=typeof window.localStorage),getItem:function(t){return this._support?window.localStorage.getItem(t):null},setItem:function(t,e){this._support&&window.localStorage.setItem(t,e)},removeItem:function(t){this.getItem(t)&&window.localStorage.removeItem(t)}},unhtml:function(t,e){return t?t.replace(e||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(t,e){return e?t:{"<":"","&":"",'"':"",">":"","'":""}[t]}):""},html:function(t){return t?t.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(t){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "}[t]}):""},hashManage:{prependHash:"!",_change:function(t,e){var i,o=location.hash,a={},s="",n=0;o&&(o=o.substring(1),this.prependHash&&(o=o.replace(new RegExp("^"+this.prependHash.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")),""))),i=o.split("&");for(var r,l=0;l<i.length;l++){var c=i[l].split("=")[0],d=i[l].split("=")[1];c&&(a[c]=decodeURIComponent(d))}if("object"==typeof t)for(var p in t){var m=t[p];m?a[p]=encodeURIComponent(m):!1===m&&delete a[p]}else if(e)a[t]=encodeURIComponent(e);else{if(!1!==e)return void 0===t?a:a[t]||null;delete a[t]}for(r in a)s+=0!=n?"&":this.prependHash,s+=r+"="+a[r],n++;return location.hash=s,a},get:function(t){return this._change(t,null)},set:function(t,e){return this._change(t,e)},clear:function(){location.hash=""}},getColor16:function(t){function o(t){t=parseInt(t).toString(16);return 1==t.length?"0"+t:t}function e(t){for(var e="#",i=0;i<3;i++)e+=o(t[i]);return e}return null!=t.match(/\((.*)\)/)?e(t.match(/\((.*)\)/)[1].split(",")):null!=t.match(/,+/g)?e(t.split(",")):o(t)},serializeParam:function(t){var e,i=[];for(e in t)if("function"!=(typeof t[e]).toLowerCase()&&"object"!=(typeof t[e]).toLowerCase())i.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));else if($.isArray(t[e]))for(var o=0;o<t[e].length;o++)i.push(encodeURIComponent(e)+"[]="+encodeURIComponent(t[e][o]));return i.join("&")},query2json:function(t){if($.isPlainObject(t))return t;if(void 0===t)return{};for(var e=t.split("&"),i={},o=0;o<e.length;o++){var a=e[o].split("=");i[a[0]]=a[1]}return i},hash2json:function(){return 1<window.location.href.split("#").length?this.query2json(window.location.href.split("#")[1].split("?")[0].replace(/#/,"")):{}},query:{get:function(t){var e=s.query2json(this._getQuery());return t?e[t]:e},set:function(t,e){var i=s.query2json(this._getQuery()),o=s.hash2json();if("object"==typeof t)for(var a in t)this._set(i,a,t[a]);else this._set(i,t,e);return s.makeUrl("",i,o)},_set:function(t,e,i){return null===i?delete t[e]:t[e]=i,t},_getQuery:function(){return void 0!==window.location.search?window.location.search.substring(1):window.location.href.split("?")[1]?window.location.href.split("?")[1].split("#")[0]:""}},makeUrl:function(t,e,i){e=this.serializeParam(e),i=this.serializeParam(i),t=e?(t||location.pathname)+"?"+e:t||location.pathname;return i&&(t=t+"#"+i),t},formatNum:function(t,e){if(void 0===t||"string"==typeof t&&isNaN(parseInt(t)))return"--";var i={"万":1e4},i=i[e="string"==typeof e?e:"万"]||i["万"];if(!("string"==typeof t&&0<=t.indexOf(e))){if("string"==typeof t&&0<=t.indexOf(",")){for(var o=t.split(","),a="",s=0;s<o.length;s++)a+=o[s];t=a}return i<=(t=parseInt(t))&&(t=(t/i).toFixed(1)+e),t}},parseCardProps:function(t,e){var i,o={"data-gk":t.play,"data-sc":t.favorites,"data-pl":t.review,"data-dm":t.video_review,"data-up":t.author,"data-subtitle":t.subtitle,"data-lm":t.typename||"","data-tg":t.created?new Date(1e3*t.created).format("yyyy-MM-dd hh:mm"):t.create||t.created_at,"data-txt":t.description,"data-yb":t.coins},a="";if("string"!=e)return o;for(i in o)""!=a&&(a+=" "),a+=i+'="'+o[i]+'"';return a},newParseCardProps:function(t,e){return{"data-gk":t.stat.view,"data-sc":t.stat.favorite,"data-pl":t.stat.reply,"data-dm":t.stat.danmaku,"data-up":t.owner.name,"data-lm":t.tname||"","data-tg":new Date(1e3*t.pubdate).format("yyyy-MM-dd hh:mm"),"data-txt":t.desc,"data-yb":t.stat.coin}},protocolRelative:function(t){return/http:|https:/.test(t)?t.replace(/http:|https:/,window.location.protocol):$.browser.msie&&parseInt($.browser.version)<=8?window.location.protocol+t:t},formatDuration:function(t,e,i){if("number"!=typeof t)return t;i=i||-1;var o=this.toFixed(t%60,2),a=e?this.toFixed(Math.floor(t%3600/60),2):this.toFixed(Math.floor(t/60),i),i=e?this.toFixed(Math.floor(t/3600),i):null;return(null===i?[a,o]:[i,a,o]).join(":")},isObject:function(t){return"object"==typeof t&&null!==t},isNothing:function(t){return null==t},isUndefined:function(t){return void 0===t},join:function(){return Array.prototype.join.call(arguments,"")},random:function(t,e){return this.isNothing(e)&&(e=t,t=0),Math.floor(Math.random()*(e-t+1))+t},debounce:function(t,e,i){var o;function a(){clearTimeout(o),i&&s.isNothing(o)&&t(),o=setTimeout(t,e||100)}return a.clearNext=function(){clearTimeout(o)},a},throttle:function(i,o,a){var s,n=0;function r(){n=a.head?0:(new Date).getTime(),s=null,i()}function t(){var t,e=(new Date).getTime();!n&&a.head&&(n=e),(t=o-(e-n))<=0||o<t?(clearTimeout(s),s=null,n=e,i()):s||a.tail||(s=setTimeout(r,t))}return o=o||200,a=a||{},t.clearNext=function(){clearTimeout(s),s=null,n=0},t},toFixed:function(t,e){if("number"!=typeof t&&"string"!=typeof t)return t;for(t=String(t),e=Number(e)||2;t.length<e;)t="0"+t;return t.length>e?t:t.slice(-e)},thumbnail:function(t,e,i){if("string"!=typeof t)return t;if(void 0===e)return t;var o,a=t.split("?");return o={midfix:"/"+e+"_"+(i=i||e),suffix:"_"+e+"x"+i},e={bfs:/_\d+x\d+\./,other:/\/\d+_\d+\//},(i={cdn:/^http.+i[0-2]\.hdslb\.com\//,bfs:/^http.+i\d\.hdslb\.com\/bfs\//,group1:/^http.+i\d\.hdslb\.com\/group1\//,other:/(^http.+i\d\.hdslb\.com)(\/.+)/}).cdn.test(a[0])&&(e.bfs.test(a[0])||e.other.test(a[0])||(i.bfs.test(a[0])||i.group1.test(a[0])?(a[0]+=o.suffix+a[0].slice(a[0].lastIndexOf(".")),t=a.join("?")):(i=i.other.exec(a[0]))&&(a[0]=i[1]+o.midfix+i[2],t=a.join("?")))),t},isWebp:function(){try{return 0==document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch(t){return!1}}(),webp:function(t,e){if(!t)return t;var i=t.match(/(.*\.(jpg|jpeg|gif|png|bmp))(\?.*)?/),o=-1!=t.indexOf("/bfs/");if(!i||"gif"===i[2]||"bmp"===i[2]||!o)return t;o=e.w,t=e.h,t=o&&t?"@"+o+"w_"+t+"h":"@",e=i[3]||"";return this.isWebp?i[1]+t+".webp"+e:i[1]+t+"."+i[2]+e},isAlpha:function(t,e){var i;return localStorage.getItem("machineDna")?i=localStorage.getItem("machineDna"):(i=parseInt(10*Math.random()+1),localStorage.setItem("machineDna",i)),!!(this.isBeta(t)||e<i)},isBeta:function(t){var e=!1,i=s.cookie.get("DedeUserID").slice(-1);return i&&$.isArray(t)&&(e=-1<$.inArray(+i,t)),e},trimHttp:function(t){return t?t.replace(/^http:/,""):""},getByteLen:function(t){for(var e=0,i=0;i<t.length;i++)null!=t.charAt(i).match(/[^\x00-\xff]/gi)?e+=1:e+=.5;return e},videoReport:function(t){window.spmReportData&&(window.spmReportData[t]=t)},customReport:function(t,e){window.reportConfig&&window[reportConfig.msgObjects]&&(e=e||t,window[reportConfig.msgObjects][t]=e)},formatLotteryTime:function(t){t*=1e3;t=new Date(t);return t.getFullYear()+"年"+(t.getMonth()+1)+"月"+t.getDate()+"日 "+t.getHours()+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())}};t.exports=s},function(t,e,i){i(7);var r=2e4;function o(t){if(this.params={evType:"over",center:!0,Overlap:!1,focusShowPos:"up",zIndex:null,animation:"fade",position:null,event:null,bound:!0,margin:5,backdrop:!1,bindInput:!1},"string"==typeof t&&(t={evType:t}),"object"==typeof t)for(var e in this.params)t.hasOwnProperty(e)&&(this.params[e]=t[e])}o.prototype={timer:null,msgbox:null,bindobj:null,backobj:null,incomingTimer:null,position:{},reverseMap:{up:"down",down:"up",left:"right",right:"left"},show:function(t,e,i,o,a){if(t=$(t),0!=this.params.Overlap||"yes"!=t.attr("hasMessageBox")){t.attr("hasMessageBox","yes"),void 0===i&&(i=1e3),void 0===o&&(o="msg"),"button"==i&&(a=o,o=i,i=1e3);var s=i;0==i&&(s=50);var n=this;return n.leftTimer=function(){"button"!=o&&(clearTimeout(n.timer),n.timer=setTimeout(function(){clearTimeout(n.timer),n.close(n)},s))},n.incomingTimer=function(){clearTimeout(n.timer)},this.bindobj=t,this.msgbox=$('<div class="m-layer m_layer"><div class="bg"><div class="content"><div class="mini"><div class="msg-text"><i class="b-icon"></i>'+e+"</div>"+("button"==o?'<div class="btnbox"><a class="b-btn ok">确认</a><a class="b-btn-cancel cancel">取消</a></div>':"")+"</div></div></div></div>").prependTo("body"),this.msgbox.addClass("m-"+o),n.params.backdrop&&(n.backobj=$('<div class="m-backdrop"></div>').css({position:"fixed",top:0,left:0,right:0,bottom:0,opacity:.6,backgroundColor:"#000",zIndex:(n.params.zIndex||r)-1}).appendTo("body")),"over"==this.params.evType?(t.bind("mouseleave",n.leftTimer),t.bind("mouseenter",n.incomingTimer),this.msgbox.bind("mouseenter",function(){clearTimeout(n.timer)}),this.msgbox.bind("mouseleave",n.leftTimer)):t.bind("blur",n.leftTimer),this.setPos(),this.msgbox.css("z-index",n.params.zIndex||r++),this.params.bindInput&&"error"==o&&(t.is(":text")||t.is("textarea")?t.addClass("error").on("focus.m-error",this.closeErrHandler()):0<t.find(":text,textarea").length&&t.addClass("error").find(":text,textarea").on("focus.m-error",this.closeErrHandler())),"button"==o&&(this.msgbox.find(".ok").click(function(){void 0!==a&&0==a(n)||n.close()}),this.msgbox.find(".cancel").click(function(){n.close()})),0!=i&&n.leftTimer(),"fade"!=this.params.animation?this.msgbox.addClass(this.params.animation):this.moveIn(this.params.focusShowPos),this.bindobj.data("b-msgbox",this),this.msgbox}},close:function(){function t(){e.msgbox.remove(),e.params.backdrop&&e.backobj.remove(),"over"==e.params.evType&&e.bindobj.off("mouseenter",e.incomingTimer),e.bindobj.off("over"==e.params.evType?"mouseleave":"blur",e.leftTimer)}var e=this;this.bindobj.attr("hasMessageBox",""),("fade"!=this.params.animation?this.msgbox.removeClass(this.params.animation):this.msgbox).fadeOut(200,t)},closeErrHandler:function(){var e=this;return function(){var t=e.bindobj.removeClass("error");e.close(),t.is(":text")||t.is("textarea")?t.off("focus.m-error"):0<t.find(":text,textarea").length&&t.find(":text,textarea").off("focus.m-error")}},moveIn:function(t){var e={opacity:1},i=5,o=5;switch(t){case"up":e.top="-=5",o=0;break;case"down":e.top="+=5",i=-i,o=0;break;case"left":e.left="-=5",i=0;break;case"right":e.left="+=5",o=-o,i=0;break;default:e.top="-=5",o=0}this.msgbox.show().css({top:this.position.top+i,left:this.position.left+o,opacity:0}),this.msgbox.animate(e,200)},setPos:function(){this.params.position?(this.position=this.params.position,this.resetBound()):this._pos(this.params.focusShowPos),this.msgbox.css("left",this.position.left),this.msgbox.css("top",this.position.top)},_pos:function(t,e){var i=this.bindobj;switch(this.params.focusShowPos=t){case"up":this.position.top=i.offset().top-this.msgbox.outerHeight()-this.params.margin,this.position.left=i.offset().left,this.params.center&&(this.position.left=this.position.left-this.msgbox.outerWidth()/2+i.outerWidth()/2);break;case"down":this.position.top=i.offset().top+i.outerHeight()+this.params.margin,this.position.left=i.offset().left,this.params.center&&(this.position.left=this.position.left-this.msgbox.outerWidth()/2+i.outerWidth()/2);break;case"left":this.position.top=i.offset().top,this.position.left=i.offset().left-this.msgbox.outerWidth()-this.params.margin;break;case"right":this.position.top=i.offset().top,this.position.left=i.offset().left+i.outerWidth()+this.params.margin}if(!this.checkBound(t)){if(!0!==e)return this._pos(this.reverseMap[t],!0);this.setBound("down"),this.setBound("left"),this.position.top-=10,this.position.left+=10}return this.resetBound(),this.position},resetBound:function(t){if(this.params.bound||!0===t)for(var e=["up","down","left","right"],i=0;i<e.length;i++){var o=e[i];this.checkBound(o)||this.setBound(o)}},checkBound:function(t){switch(t){case"up":return this.position.top>=$(window).scrollTop();case"down":return this.position.top+this.msgbox.outerHeight()<=$(window).height()+$(window).scrollTop();case"left":return this.position.left>=$(window).scrollLeft();case"right":return this.position.left+this.msgbox.outerWidth()<=$(window).width()+$(window).scrollLeft();default:return!0}},setBound:function(t){switch(t){case"up":this.position.top=$(window).scrollTop();break;case"down":this.position.top=$(window).height()+$(window).scrollTop()-this.msgbox.outerHeight();break;case"left":this.position.left=$(window).scrollLeft();break;case"right":this.position.left=$(window).width()+$(window).scrollLeft()-this.msgbox.outerWidth()}}},t.exports=o},function(t,e){function i(){}i.prototype={addBlacklist:function(t,e,i){var o=e||null;$.ajax({url:"//web.archive.org/web/20201122165301/https://api.bilibili.com/x/relation/modify?cross_domain=true",type:"POST",data:{fid:t,act:5,re_src:i||15},xhrFields:{withCredentials:!0}}).done(function(t){o(t)})},follow:function(t,e,i){var o=e||null;$.ajax({url:"//web.archive.org/web/20201122165301/https://api.bilibili.com/x/relation/modify?cross_domain=true",type:"POST",data:{fid:t,act:1,re_src:i||15},xhrFields:{withCredentials:!0}}).done(function(t){o(t)})},whisperUser:function(t,e){e=e||null;this.todoFriend({act:"add",attention:0,format:"json",uid:t},e)},unFollow:function(t,e,i,o){var a=e||null;$.ajax({url:"//web.archive.org/web/20201122165301/https://api.bilibili.com/x/relation/modify?cross_domain=true",type:"POST",data:{fid:t,act:i?4:2,re_src:o||15},xhrFields:{withCredentials:!0}}).done(function(t){a(t)})},delFans:function(t,e){e=e||null;this.todoFriend({act:"delFans",attention:0,format:"json",uid:t},e)}},t.exports=i},function(t,e,i){var o,m,a,s,n,u=i(0),h=i(1),r=i(4),l=i(5),f=new(i(2)),c=i(6);function d(){var i=$.ajax;$.ajax=function(t,e){return"object"==typeof t&&(e=t,t=void 0),"post"!=e.type&&"POST"!=e.type||!e.data||e.data.csrf||$.extend(e.data,{csrf:u.cookie&&u.cookie.get("bili_jct")}),i(t,e)}}function p(){$.fn.paging=function(t){t=$.extend({pageCount:10,current:1,jump:!1,backFn:function(){}},t);c.init(this,t)}}function b(t,e,i,o,a,s){var n={isLogin:!(this.noface="//web.archive.org/web/20201122165301/https://static.hdslb.com/images/member/noface.gif"),face:this.noface,vipStatus:0,vipType:0};if(this.upId="","object"==typeof e){var r=e;this.oid=r.oid,this.pageType=r.pageType;o=r.userState;if(this.noLevelLimit=r.noLevelLimit,this.jumpId=r.jumpId,this.noPage=r.noPage,this.pageSize=r.pageSize||20,this.dynamicRepost=r.dynamicRepost,this.contentMaxLength=r.contentMaxLength||1e3,this.smallPager=r.smallPager,this.disableText=r.disableText,r.domain)for(var l in m)m[l]=m[l].replace("api.bilibili.com",r.domain)}else this.oid=e,this.pageType=i,this.jumpId=a,this.mounted=s&&s.mounted||null,this.contentMaxLength=1e3;this.sort=2,this.loaded=!1,this.loading=!1,this.firstLoad=!1,this.emojiLoaded=!1,this.userStatus=n,this.fbData=[],this.events={},this.pageInfo={},this.foldedReply={},this.isViewHot=!1,this.readOnly=!1,this.blacklistCode=9,this.blacklist=0,this.assist=0,this._pos=-1,this.showBv=!1,this.currentPage=1,this.sendPosition=1,this.control={bg_text:"",child_input_text:"",input_disable:!1,root_input_text:"",web_selection:!1},this.jumpReportIndex=0,this.jumpReport={},this.interactionStatus={selection:0,reply:0,dm:0};var c=this;return window.jQuery?(d(),p(),this.start(t,o)):((n=document.createElement("script")).setAttribute("src","//web.archive.org/web/20201122165301/https://s1.hdslb.com/bfs/static/jinkela/long/js/jquery/jquery3.3.1.min.js"),document.body.appendChild(n),n.onload=function(){p(),d(),c.start(t,o)}),this}i(20),o=window,m={nav:"//web.archive.org/web/20201122165301/https://api.bilibili.com/x/web-interface/nav",reply:i="//web.archive.org/web/20201122165301/https://api.bilibili.com/x/v2/reply",subReply:i+"/reply",report:i+"/report",blacklist:i+"/blacklist",add:i+"/add",emoji:"//web.archive.org/web/20201122165301/https://api.bilibili.com/x/emote/user/panel/web?business=reply",setTop:i+"/top",like:i+"/action",hate:i+"/hate",del:i+"/del",lotteryDel:i+"/lottery/del",jump:i+"/jump",folded:i+"/folded",replyFolded:i+"/reply/folded",interactionStatus:i+"/subject/interaction-status",interactionModify:i+"/subject/modify",dmModify:"//web.archive.org/web/20201122165301/https://api.bilibili.com/x/v2/dm/subject/state/update"},a={header:['<div class="comment-header clearfix">','<div class="tabs-order">','<ul class="clearfix">','<li class="default-sort" data-sort="0">全部评论</li>','<li data-sort="2" class="hot-sort  on"></li>','<li data-sort="0" class="new-sort">按时间排序</li>',"</ul>","</div>",'<div class="header-interaction"></div>',"</div>"].join("")},s=window.localStorage&&window.localStorage.getItem,n="commentNotice",b.prototype.on=function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)},b.prototype.trigger=function(t){if(this.events[t]){for(var e=[],i=this,o=1;o<arguments.length;o++)e.push(arguments[o]);this.events[t].forEach(function(t){t.apply(i,e)})}},b.prototype.quickLogin=function(){u.browser.version.mobile?location.href="//web.archive.org/web/20201122165301/https://passport.bilibili.com/login":window.biliQuickLogin?window.biliQuickLogin(function(t){window.location.reload()}):$.getScript("//web.archive.org/web/20201122165301/https://static.hdslb.com/account/bili_quick_login.js",function(){window.biliQuickLogin(function(t){window.location.reload()})})},b.prototype.start=function(t,e){var i=this,o={isLogin:!1,face:this.noface,vipStatus:0,vipType:0};this.$root=$(t),this.$root.length&&(window.reportObserver&&(reportObserver.scrollTracker?(reportObserver.scrollTracker.scrollReportOffset=1,reportObserver.scrollTracker.customReport(i.$root[0],".list-item","replyCardShow",{type:i.pageType,oid:i.oid,page:function(){return i.currentPage},ordering:function(){return 2===i.sort?"heat":"time"},rpid:function(t){return $(t).data("id")}})):"function"==typeof reportObserver.importTracker&&(reportObserver.importTracker("scroll"),window.onScrollTrackerLoaded=function(){reportObserver.scrollTracker.scrollReportOffset=1,reportObserver.scrollTracker.customReport(i.$root[0],".list-item","replyCardShow",{type:i.pageType,oid:i.oid,page:function(){return i.currentPage},ordering:function(){return 2===i.sort?"heat":"time"},rpid:function(t){return $(t).data("id")}})})),this._fixRootPosition(),this.userCard=new l(this.userStatus),this._registerEvent(),e?(this.userStatus=$.extend({},o,e),this.init()):$.ajax({url:m.nav,type:"GET",dataType:"jsonp",data:{jsonp:"jsonp"},xhrFields:{withCredentials:!0}}).done(function(t){t&&0==t.code&&(i.userStatus=$.extend({},o,t.data))}).always(function(){i.init()}))},b.prototype.init=function(t){t&&(this.userStatus=$.extend({},defaultStatus,t));try{var e=['<div class="bb-comment '+(u.browser.version.mobile?"bb-comment-h5":"")+'">','<div class="reply-notice"></div>',a.header,'<div class="comment-list '+(this.pageSize?"has-limit":"")+'"></div>','<div class="bottom-page '+(u.browser.version.mobile?"paging-box":"paging-box-big")+'"></div>',"</div>"].join("");this.$root.html(e),this._showLoading("<span>loading...</span>"),this.userStatus.isLogin&&this._renderInteractionManage(),this.jumpId?this.jumpToReply(this.jumpId):this._isInView(this.$root)&&this.loadPage(1),this.userCard.reset(this.userStatus)}catch(t){window.console&&window.console.log("[comment]",t)}},b.prototype._fixRootPosition=function(){"static"==this.$root.css("position")&&this.$root.css({position:"relative"})},b.prototype._fixEmojiPosition=function(){u.browser.version.mobile||(0<$(".comment-fold-bilibili").length?$(".comment-fold-bilibili .reply-item"):this.$root.find(".reply-box .reply-item")).each(function(t,e){var i=$(e).find(".reply-face"),o=$(e).find(".user"),e=$(e).find(".name");i&&o&&e&&(10<e.offset().top-o.offset().top?i.css("top","32px"):i.css("top","0"))})},b.prototype._getEmoji=function(e,i,o){var a=this;a.emojiLoaded=!0,$.ajax({url:m.emoji,xhrFields:{withCredentials:!0}}).done(function(t){t&&t.data&&0===t.code&&(t=t.data.packages||[],t=a.handleEmojiData(t),a.emoji=new r(a.$root,t),a.emoji.show(e,i,o),$(".emoji-box").css("zIndex",10001),a.trigger("emojiLoaded"))}).fail(function(){a.emojiLoaded=!1,a.loaded||a._showLoading('<span>加载失败，<a class="reload-comment">点击重试</a></span>')})},b.prototype.handleEmojiData=function(t){for(var e=[],i=0;i<t.length;i++)if(!t[i].flags||!t[i].no_access){for(var o=t[i],a={pid:o.id,pname:o.text,pstate:0,purl:o.url,type:o.type,emojis:[],size:o.meta&&1===o.meta.size?"s":"l"},s=0;s<o.emote.length;s++){var n=o.emote[s],n={id:n.id,name:n.text,url:n.url,state:0,size:n.meta&&1===n.meta.size?"s":"l"};a.emojis.push(n)}e.push(a)}return e},b.prototype._renderNotice=function(t){var e,i;t&&(e="",i=s?+window.localStorage.getItem(n):0,t.id>i&&((i=t.link)&&-1!==i.indexOf("__MID__")&&-1!==i.indexOf("__REQUESTID__")&&this.userStatus.mid?t.link=i.replace("__MID__",this.userStatus.mid||"__MID__").replace("__REQUESTID__",t.id||"__REQUESTID__"):t.link=i,e+='<div class="notice-item" data-id="'+t.id+'"><i class="icon-close-notice"></i><i class="icon-notice"></i><a href="'+t.link+'" target="_blank">'+t.content+"</a></div>"),this.$root.find(".reply-notice").html(e))},b.prototype._resolveEmoji=function(t,o){var e=new RegExp(/\[[^\]]+\]/g);return t.replace(e,function(t){if(o[t]){var e=o[t];if(4===e.type)return e.url;var i=e.meta&&1===e.meta.size?"s":"l";return'<img src="'+u.trimHttp(u.webp(e.url,{w:100,h:100}))+'"'+("s"==i?' class="small"':"")+' alt="'+e.text+'">'}return t})},b.prototype._resolveJump=function(t,e){for(var i in e){var o,a,s,n;0<=t.indexOf(i)&&(o=(n=e[i]).prefix_icon?'<img src="'+n.prefix_icon+'" class="jump-img"/>':"",s=u.unhtml(n.title),a=0===i.indexOf("http")?i:this._createLinkById(i),s=o+(0===n.state?'<a href="'+a+'" data-report="'+this.jumpReportIndex+'" class="comment-jump-url" target="_blank">'+s+"</a>":s),this.jumpReport[this.jumpReportIndex]=n.click_report,this.jumpReportIndex++,n=new RegExp(i.replace(/\?/,"\\?"),"ig"),t=t.replace(n,s))}return t},b.prototype._createLinkById=function(t){return 0===t.indexOf("av")||0===t.indexOf("BV1")?"//web.archive.org/web/20201122165301/https://www.bilibili.com/video/"+t:0===t.indexOf("cv")?"//web.archive.org/web/20201122165301/https://www.bilibili.com/read/"+t:void 0},b.prototype._resolveUrl=function(t){var e=/(http(s)?:\/\/)?([a-z0-9A-Z]+.)?(bilibili.(com|tv|cn)|biligame.(com|cn)|(bilibiliyoo|im9).com|biliapi.net|b23.tv|sugs.suning.com|kaola.com)(\$|\/|)([/.$*?~=#!%@&-A-Za-z0-9_]*)(?![^<>]*>|[^"]*?<\/a)/gi;t.match(e);return t.replace(e,function(t){var e=t;return 0!==t.indexOf("http")&&(e="//"+e),'<a href="'+e+'" target="_blank">'+t+"</a>"})},b.prototype._resolveSeek=function(o){var t,a=this;return 1===this.pageType&&((t=o.match(/(\d+\#)?(\d+(\:|\：)){1,2}\d\d/g))&&t.forEach(function(t){var e,i;i=0<t.indexOf("#")?(e=parseInt(t.split("#")[0]),t.split("#")[1]):(e=-1,t),a._timeStrToNumber(i)&&(i=a._timeStrToNumber(i),o=o.replace(t,'<a class="video-seek" data-p="'+e+'" data-time="'+i+'">'+t+"</a>"))})),o},b.prototype._resolveVote=function(t,e){return e.vote?t.replace(/\{vote:.*}/,'<a class="vote-link" data-id="'+e.vote.id+'" data-name="'+u.unhtml(e.vote.title)+'"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjAuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IuWbvuWxgl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIKCSB2aWV3Qm94PSIwIDAgMjggMjkiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDI4IDI5OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+Cjx0aXRsZT5Hcm91cCAyPC90aXRsZT4KPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CjxnIGlkPSJQYWdlLTEiIHN0eWxlPSJmaWxsOiMwMEExRDYiPgoJPGcgaWQ9IuWwgemdoiI+CgkJPGcgaWQ9Ikdyb3VwLTIiPgoJCQk8ZyBpZD0iUmVjdGFuZ2xlLTUiPgoJCQkJPHBhdGggZD0iTTMuMywyOC4zQzEuNSwyOC4zLDAsMjYuOSwwLDI1VjEwLjFjMC0xLjgsMS41LTMuMywzLjMtMy4zczMuMywxLjUsMy4zLDMuM1YyNUM2LjcsMjYuOSw1LjIsMjguMywzLjMsMjguM3ogTTMuMyw4CgkJCQkJYy0xLjIsMC0yLjEsMS0yLjEsMi4xVjI1YzAsMS4yLDEsMi4xLDIuMSwyLjFzMi4xLTEsMi4xLTIuMVYxMC4xQzUuNSw4LjksNC41LDgsMy4zLDh6Ii8+CgkJCTwvZz4KCQkJPGcgaWQ9IlJlY3RhbmdsZS01XzFfIj4KCQkJCTxwYXRoIGQ9Ik0xNCwyOC40Yy0xLjgsMC0zLjMtMS41LTMuMy0zLjNWMy4zQzEwLjcsMS41LDEyLjIsMCwxNCwwczMuMywxLjUsMy4zLDMuM1YyNUMxNy4zLDI2LjksMTUuOCwyOC40LDE0LDI4LjR6IE0xNCwxLjIKCQkJCQljLTEuMiwwLTIuMSwxLTIuMSwyLjFWMjVjMCwxLjIsMSwyLjEsMi4xLDIuMWMxLjIsMCwyLjEtMSwyLjEtMi4xVjMuM0MxNi4xLDIuMiwxNS4yLDEuMiwxNCwxLjJ6Ii8+CgkJCTwvZz4KCQkJPGcgaWQ9IlJlY3RhbmdsZS01XzJfIj4KCQkJCTxwYXRoIGQ9Ik0yNC43LDI4LjRjLTEuOCwwLTMuMy0xLjUtMy4zLTMuM3YtNi44YzAtMS44LDEuNS0zLjMsMy4zLTMuM3MzLjMsMS41LDMuMywzLjNWMjVDMjgsMjYuOSwyNi41LDI4LjQsMjQuNywyOC40egoJCQkJCSBNMjQuNywxNi4xYy0xLjIsMC0yLjEsMS0yLjEsMi4xVjI1YzAsMS4yLDEsMi4xLDIuMSwyLjFzMi4xLTEsMi4xLTIuMXYtNi44QzI2LjgsMTcsMjUuOCwxNi4xLDI0LjcsMTYuMXoiLz4KCQkJPC9nPgoJCTwvZz4KCTwvZz4KPC9nPgo8L3N2Zz4K" alt="" />'+u.unhtml(e.vote.title)+"</a>"):t},b.prototype._resolveLottery=function(t,e){return e.lottery?t.replace(/\{lottery:.*}/,'<a class="lottery-link" data-id="'+e.lottery.lottery_id+'"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAApVJREFUSA3tVEtoE1EUvfclE39gW7uypYKfih9UmkR3ol10Iy6aRItaUbppQSSpLhRdBTciuEhKcVFEdCNobJNuuhTduUhiKEIVUQJ+aqmgJbTWOpnrGduZxsnHhauKD4b37jn3vvPufW8u0UofXCuB7oHX62dlpoeFmxWrJ8ORtrHjD9+t0Senzwob2xSpZyNh76Nae1QVCAxONIo+l2aSWSF+QSRHyMV32KB2EVrLTGlgHeDGUhHfmWoiqhpBxtxFbPLJ3eTbl+r3nVBuOkwGhUVkXX3dhj3JiO+k0jwHEN8VjD3fX22fGgLSSiJPE11cNINHzvuzOPE3xfTqbs/meRMbPrf3LXzyooztpl1pVBVg5rQQdZ66Nd5gBTKxISi+ZR8byBxEllsUS8bCnLN9B9FoVI03HD0kzE2mEwitKHQZd7AJ5nt8gstuFaYfWOYh7oFPC7FKwmfUjFE4gCryROJCW860zWELBOO5dqHiAwSPmlst0rAIL4ikHgBA2YksFsC9gZDOBk8B/WL5Yu3BA+jWlGpKhL3TJu62SEg3o9qpZL+/18KccyCWvgfJr/CJODnLho9fV8os6+8CqOxnnLIjEM9eR8oV7wYvyAuf78F45oa1YemMrBAqW1nTCxZuZ+DeuPqx/nE+QWJEcIsuuP56PZbj0qyZRQO/y4FjX9KU8BSzujTS55108rYdiGfyoVg2ZAMlC7NE+OIlkL3sHEjfBHffBpYWFUvhdPob+7/AH6u38ktk/wfLuUrBUOQNDeZeLmOLK6Oo16GNKHC7K3A70Mc+OPFyAaFr6Dm3i7p+1em8aKNj6frpco7zmkuuOHG72ZUSaAncN5QpE1/wNLqmCrq0rJqxW7YVN9TnR5f9F8dPt6z3H8GtPW0AAAAASUVORK5CYII=" alt="" />评论抽奖</a>'):t},b.prototype._resolveAt=function(t,e){return t.replace(/(?!<a[^>]*>)@[^\s]+(?![^<]*<\/a>)/g,function(t){return e[t.trim().substring(1)]||t}).replace(/(?!<a[^>]*>)(bv1)(\w{9})(?![^<]*<\/a>)/gi,this.showBv?'<a href="//web.archive.org/web/20201122165301/https://www.bilibili.com/video/bv1$2/" target="_blank">$1$2</a>':"$1$2").replace(/(?!<a[^>]*>)av([0-9]+)(?![^<]*<\/a>)/gi,'<a href="//web.archive.org/web/20201122165301/https://www.bilibili.com/video/av$1/" target="_blank" data-view="$1">av$1</a>').replace(/(?!<a[^>]*>)cv([0-9]+)(?![^<]*<\/a>)/gi,'<a href="//web.archive.org/web/20201122165301/https://www.bilibili.com/read/cv$1/" target="_blank" data-view="$1">cv$1</a>').replace(/\n/g,"<br />")},b.prototype._timeStrToNumber=function(t){var e=t.split(/\:|\：/);if(3===e.length&&2===e[1].length&&2===e[2].length){var t=parseInt(e[0]),i=parseInt(e[1]),o=parseInt(e[2]);if(0<=i&&i<60&&0<=o&&o<60)return o+60*i+3600*t}if(2===e.length&&2===e[1].length){i=parseInt(e[0]);if(0<=(o=parseInt(e[1]))&&o<60)return o+60*i}},b.prototype._formateMemberMap=function(t){for(var e,i={},o=0,a=t.length;o<a;++o)i[(e=t[o]).uname]='<a href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+e.mid+'" target="_blank" data-usercard-mid="'+e.mid+'">@'+u.unhtml(e.uname)+" </a>";return i},b.prototype._createReplyBox=function(t){t=t||{};var e="",i="",o="",a=this.control.root_input_text||"请自觉遵守互联网相关的政策法规，严禁发布色情、暴力、反动的言论。";this.userStatus.isLogin?t.forbid||this.control.input_disable?(i=this.control.root_input_text,o=this.control.child_input_text,e="no-login"):this.disableText&&(i=this.disableText,e="no-login"):(o=i='请先<a class="b-btn btn-open-mini-Login">登录</a>后发表评论 (・ω・)',e="no-login");var s=t.forbid?"":['<div class="dynamic-repost">',"<label>",'<input type="checkbox" class="dynamic-repost-checkbox" />',"<span>同时转发到我的动态</span>","</label>","</div>"].join(""),n=t.forbid?"":['<div class="comment-emoji">','<i class="face"></i>','<span class="text">表情</span>',"</div>"].join("");return['<div class="comment-send '+e+'">','<div class="user-face">','<img class="user-head" src="'+u.trimHttp(u.webp(this.userStatus.face,{w:52,h:52}))+'" />',"</div>",'<div class="textarea-container">',i?'<div class="baffle-wrap"><div class="baffle">'+(t.isSub?o:i)+"</div></div>":"",'<i class="ipt-arrow"></i>','<textarea cols="80" name="msg" rows="5" placeholder="'+a+'" class="ipt-txt"></textarea>','<button type="submit" class="comment-submit" '+(e?'disabled="disabled"':"")+">发表评论</button>","</div>",n,!t.isSub&&this.dynamicRepost?s:"","</div>"].join("")},b.prototype.loadPage=function(o,t){var a=this;a.loading=!0,t&&$(window).scrollTop(a.$root.offset().top),this._getReplyByPage(o).done(function(t){var e,i;a._hideLoading(),a.loaded=!0,t&&0===t.code?t.data&&(a.mode=t.data.mode,a.blacklist=t.data.blacklist||0,a.assist=t.data.assist||0,a.pageInfo=t.data.page||{},a.readOnly=t.data.config.read_only,a.folder=t.data.folder||{},a.showBv=t.data.show_bvid||!1,e=a.pageInfo.num*a.pageInfo.size>=a.pageInfo.count,(i=t.data.control)&&(a.control.bg_text=i.bg_text,a.control.child_input_text=i.child_input_text,a.control.input_disable=i.input_disable,a.control.root_input_text=i.root_input_text,a.control.web_selection=i.web_selection),a._renderTabs(t),a._renderNotice(t.data.notice),a._updateReplyListByData(t.data,o,e),a._renderBottomPagination(a.pageInfo),a._fixEmojiPosition(),$(".common .b-head .results").html(t.data.page.acount||0).show(),$(".common .b-head .del-log").remove(),a.$root.find(".bb-comment > .comment-send").remove(),$(a._createReplyBox()).insertBefore(a.$root.find(".comment-list")),a.trigger("pageLoaded",e,t.data)):(a.$root.find(".bb-comment > .comment-send").remove(),a.control={bg_text:"",child_input_text:t.message||"当前稿件评论功能已关闭",input_disable:!1,root_input_text:t.message||"当前稿件评论功能已关闭",web_selection:!1},$(a._createReplyBox({forbid:!0})).insertBefore(a.$root.find(".comment-list")),a.$root.find(".comment-header .tabs-order .hot-sort").html("评论关闭"),a.$root.find(".comment-header .tabs-order .new-sort").hide(),a._renderReplyList([]))}).fail(function(){a.loaded||a._showLoading('<span>加载失败，<a class="reload-comment">点击重试</a></span>')}).always(function(){a.loading=!1})},b.prototype._renderTabs=function(t){if(!this.firstLoad){this.firstLoad=!0,u.customReport("replyShow",{ordering:3===this.mode?"heat":"time",type:this.pageType,oid:this.oid});var e=this.$root.find(".comment-header .tabs-order .default-sort"),i=this.$root.find(".comment-header .tabs-order .new-sort"),o=this.$root.find(".comment-header .tabs-order .hot-sort");if(!this.control.web_selection)return 2===this.mode?(o.html("按热度排序"),e.hide().removeClass("on"),i.show().addClass("on"),o.show().removeClass("on"),this.sort=0,void(this.jumpId||this.loadPage(1))):3===this.mode?(o.html("按热度排序"),e.hide().removeClass("on"),i.show(),void o.show().addClass("on")):(t.data.page&&20<=t.data.page.count||t.data.hots||2===this.sort?o.show():o.hide(),void(t.data.hots?this.isViewHot=!0:this.isViewHot=!1));o.html("精选评论")}},b.prototype._updateReplyListByData=function(t,e,i){var o=[],a=-1,s=this;s.upId=t.upper&&t.upper.mid,s.hasUpTop=t.upper&&t.upper.top,t.lottery_card&&(t.lottery_card.isUpTop=!0,o.push(t.lottery_card)),t.top&&1===s.pageInfo.num&&(t.top.isTop=!0,o.push(t.top)),t.upper&&t.upper.top&&1===s.pageInfo.num&&(t.upper.top.isUpTop=!0,o.push(t.upper.top)),t.upper&&t.upper.vote&&1===s.pageInfo.num&&(t.upper.vote.isUpTop=!0,o.push(t.upper.vote)),1===e&&0===s.sort&&2!==s.mode&&3!==s.mode&&(s.isViewHot&&(o=o.concat(t.hots||[])),a=t.hots&&0<t.hots.length?o.length:-1,s._pos=a),o=t.replies instanceof Array?0<o.length?s._uniq(o.concat(t.replies)):o.concat(t.replies):0<o.length?s._uniq(o):o,this.noPage&&this.pageSize&&(o=o.slice(0,this.pageSize)),s._renderReplyList(o,a,i)},b.prototype._uniq=function(t){var e={};return t.filter(function(t){return!e.hasOwnProperty(t.rpid)&&(e[t.rpid]=!0)})},b.prototype._renderInteractionManage=function(){var e=this;$.ajax({url:m.interactionStatus,type:"GET",data:{type:this.pageType,oid:this.oid},xhrFields:{withCredentials:!0}}).done(function(t){t&&0===t.code&&e._rednderInteractionDom(t.data)})},b.prototype._rednderInteractionDom=function(t){var e=t.up_reply_selection,i=t.up_reply,o=t.up_dm;this.interactionStatus={selection:e.status,reply:i.status,dm:o.status},t.can_modify&&(o=['<div class="operation ineraction-operation">','<div class="spot"></div>','<div class="opera-list">',"<ul>",e.can_modify?'<li class="up_reply_selection">'+(e.status?"停止":"开启")+"评论精选</li>":"",i.can_modify?'<li class="up_reply">'+(i.status?"关闭":"恢复")+"评论</li>":"",o.can_modify?'<li class="up_dm">'+(o.status?"关闭":"恢复")+"弹幕</li>":"","</ul>","</div>","</div>"].join(""),this.$root.find(".header-interaction").html(o))},b.prototype._renderBottomPagination=function(t){var e,i;this.noPage?(i="",i=t.count<=this.pageSize?"没有更多了～":'<a class="more-link" href="javascript:">查看更多评论</a>',this.$root.find(".bottom-page").addClass("center").html(i)):(e=this,1<(i=Math.ceil(t.count/t.size))?this.$root.find(".bottom-page").paging({pageCount:i,current:t.num,jump:!u.browser.version.mobile,smallSize:this.smallPager,backFn:function(t){e.$root.trigger("replyPageChange",{p:t,isBottom:!0}),e.trigger("replyPageChange",{p:t,isBottom:!0}),e.currentPage=t,u.videoReport("playpage_comment_pageclick2")}}):this.$root.find(".bottom-page").html(""))},b.prototype._renderReplyList=function(t,e,i){var o="";if(t){if(0!==(this.fbData=t).length||this.noPage){this.$root.find(".no-more-reply").remove();for(var a=0,s=t.length;a<s;++a){var n=t[a];n&&((a<e||n.isUpTop||n.isTop)&&(n.isHot=!0),o+=this._createReplyItem(n,a,e),e&&a===e-1&&this.isViewHot&&e<t.length&&(o+='<div class="hot-line"><span>以上为热门评论，<a class="more-hot">查看更多</a></span></div>'))}i&&this.folder.has_folded&&!u.browser.version.mobile&&(o+='<div class="reply-fold-tip"><a class="view-fold">查看被折叠的评论</a><a href="'+this.folder.rule+'" class="fold-rule" target="_blank">（折叠规则）</a></div>')}else o+='<div class="no-more-reply">'+(this.control.bg_text||"没有更多信息")+"</div>";this.$root.find(".comment-list").html(o),this.mounted&&this.mounted(t)}},b.prototype._createReplyItem=function(t,e,i){return t.folder&&t.folder.has_folded&&(this.foldedReply[t.rpid]=t),['<div class="list-item reply-wrap '+(t.isTop||t.isUpTop?"is-top":"")+'" data-id="'+t.rpid+(t.lottery_id?'" data-lottery-id='+t.lottery_id:'"')+' data-index="'+e+'">',this._createUserFace(t),this._createListCon(t,e,i),"</div>"].join("")},b.prototype._createTopFoldedReplyItem=function(t){return['<div class="list-item reply-wrap top-fold-reply" data-id="'+t.rpid+'">',this._createUserFace(t),this._createTopFoldedListCon(t),"</div>"].join("")},b.prototype._createSubFoldedReplyItem=function(t,e){return['<div class="list-item reply-wrap '+(e?"no-border":"")+'" data-id="'+t.rpid+'">',this._createUserFace(t),this._createSubFoldedListCon(t),"</div>"].join("")},b.prototype._createLegalizeIcon=function(t){var e="";return t&&0==t.type?e='<div class="legalize p-auth" title="个人认证"></div>':t&&1==t.type&&(e='<div class="legalize o-auth" title="企业/团体认证"></div>'),e},b.prototype._createUserFace=function(t){var e='<div class="user-face"><img src="'+this.noface+'"></div>',i=['<div class="user-face">','<a href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.mid+'" target="_blank" data-usercard-mid="'+t.mid+'">','<img src="'+u.trimHttp(u.webp(t.member.avatar,u.browser.version.mobile?{w:45,h:45}:{w:52,h:52}))+'" alt="">',"</a>",t.member.pendant&&t.member.pendant.image?'<a href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.mid+'" class="pendant" data-usercard-mid="'+t.mid+'" target="_blank"><img src="'+u.trimHttp(u.webp(t.member.pendant.image,u.browser.version.mobile?{w:71,h:71}:{w:86,h:86}))+'"></a>':"",this._createLegalizeIcon(t.member.official_verify),t.isHot?this._createFollowButton(t.member,t.rpid):"","</div>"].join("");return t.state===this.blacklistCode?e:i},b.prototype._createFollowButton=function(t,e){var o,e=['<div class="hot-follow">','<button class="follow-btn" data-mid="'+t.mid+'" data-uname="'+u.unhtml(t.uname)+'" data-rpid="'+e+'">关注</button>',"</div>"].join("");return this.userStatus.isLogin&&(o=t,$.ajax({url:"//web.archive.org/web/20201122165301/https://api.bilibili.com/x/relation",data:{fid:o.mid,jsonp:"jsonp"},dataType:"jsonp"}).done(function(t){var e,i;t&&0===t.code&&(e=$('.follow-btn[data-mid="'+o.mid+'"]'),i=1===t.data.attribute||2===t.data.attribute||6===t.data.attribute,t=1===t.data.attribute,i&&e.addClass("followed").text("已关注"),t&&e.attr("quiet",!0))})),e},b.prototype._createListCon=function(t,e,i){var o=this._parentBlacklistDom(t,e,i),a=['<div class="con '+(i==e?"no-border":"")+'">','<div class="user">'+this._identity(t.mid,t.assist,t.member.fans_detail),'<a data-usercard-mid="'+t.mid+'" href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.mid+'" target="_blank" class="name '+this._createVipClass(t.member.vip.vipType,t.member.vip.vipStatus,t.member.vip.themeType)+'">'+u.unhtml(t.member.uname)+'</a><a class="level-link" href="//web.archive.org/web/20201122165301/https://www.bilibili.com/blackboard/help.html#%E4%BC%9A%E5%91%98%E7%AD%89%E7%BA%A7%E7%9B%B8%E5%85%B3" target="_blank"><i class="level l'+t.member.level_info.current_level+'"></i></a>'+this._createNameplate(t.member.nameplate)+this._createUserSailing(t.member&&t.member.user_sailing||{})+"</div>",this._createMsgContent(t),'<div class="info">',t.floor?'<span class="floor">#'+t.floor+"</span>":"",this._createPlatformDom(t.content.plat),'<span class="time">'+this._formateTime(t.ctime)+"</span>",t.lottery_id?"":'<span class="like '+(1==t.action?"liked":"")+'"><i></i><span>'+(t.like||"")+"</span></span>",t.lottery_id?"":'<span class="hate '+(2==t.action?"hated":"")+'"><i></i></span>',t.lottery_id?"":this._createReplyBtn(t.rcount),t.lottery_id&&t.mid!==this.userStatus.mid?"":'<div class="operation more-operation"><div class="spot"></div><div class="opera-list"><ul>'+(this._canSetTop(t)?'<li class="set-top">'+(t.isUpTop?"取消置顶":"设为置顶")+"</li>":"")+(this._canBlackList(t.mid)?'<li class="blacklist">加入黑名单</li>':"")+(this._canReport(t.mid)?'<li class="report">举报</li>':"")+(this._canDel(t.mid)&&!t.isTop?'<li class="del" data-mid="'+t.mid+'">删除</li>':"")+"</ul></div></div>",this._createLotteryContent(t.content),this._createVoteContent(t.content),this._createTags(t),"</div>",'<div class="reply-box">',this._createSubReplyList(t.replies,t.rcount,!1,t.rpid,t.folder&&t.folder.has_folded),"</div>",'<div class="paging-box">',"</div>","</div>"].join("");return u.browser.version.mobile&&(a=['<div class="con '+(i==e?"no-border":"")+'">','<div class="user">'+this._identity(t.mid,t.assist,t.member.fans_detail),'<a data-usercard-mid="'+t.mid+'" href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.mid+'" target="_blank" class="name '+this._createVipClass(t.member.vip.vipType,t.member.vip.vipStatus,t.member.vip.themeType)+'">'+u.unhtml(t.member.uname)+'</a><a class="level-link" href="//web.archive.org/web/20201122165301/https://www.bilibili.com/blackboard/help.html#%E4%BC%9A%E5%91%98%E7%AD%89%E7%BA%A7%E7%9B%B8%E5%85%B3" target="_blank"><i class="level l'+t.member.level_info.current_level+'"></i></a>'+this._createNameplate(t.member.nameplate)+'<div class="right">',t.floor?'<span class="floor">#'+t.floor+"</span>":"",'<span class="time">'+this._formateMobileTime(t.ctime)+"</span></div>","</div>",this._createMsgContent(t),this._createVoteContent(t.content),'<div class="info">',this._createPlatformDom(t.content.plat),'<span class="like '+(1==t.action?"liked":"")+'"><i></i><span>'+(t.like||"")+"</span></span>",'<span class="hate '+(2==t.action?"hated":"")+'"><i></i></span>',this._createReplyBtn(t.rcount),'<div class="operation more-operation"><div class="spot"></div><div class="opera-list"><ul>'+(this._canSetTop(t)?'<li class="set-top">'+(t.isUpTop?"取消置顶":"设为置顶")+"</li>":"")+(this._canBlackList(t.mid)?'<li class="blacklist">加入黑名单</li>':"")+(this._canReport(t.mid)?'<li class="report">举报</li>':"")+(this._canDel(t.mid)&&!t.isTop?'<li class="del" data-mid="'+t.mid+'">删除</li>':"")+"</ul></div></div>","</div>",this._createTags(t),'<div class="reply-box">',this._createSubReplyList(t.replies,t.rcount,!1,t.rpid,t.folder&&t.folder.has_folded),"</div>",'<div class="paging-box">',"</div>","</div>"].join("")),t.state===this.blacklistCode?o:a},b.prototype._createSubFoldedListCon=function(t){var e=this._parentBlacklistDom(t,0),i=['<div class="con">','<div class="user">'+this._identity(t.mid,t.assist,t.member.fans_detail),'<a data-usercard-mid="'+t.mid+'" href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.mid+'" target="_blank" class="name '+this._createVipClass(t.member.vip.vipType,t.member.vip.vipStatus,t.member.vip.themeType)+'">'+u.unhtml(t.member.uname)+'</a><a class="level-link" href="//web.archive.org/web/20201122165301/https://www.bilibili.com/blackboard/help.html#%E4%BC%9A%E5%91%98%E7%AD%89%E7%BA%A7%E7%9B%B8%E5%85%B3" target="_blank"><i class="level l'+t.member.level_info.current_level+'"></i></a>'+this._createNameplate(t.member.nameplate),"</div>",this._createMsgContent(t),'<div class="info">','<span class="time">'+this._formateTime(t.ctime)+"</span>",'<span class="like '+(1==t.action?"liked":"")+'"><i></i><span>'+(t.like||"")+"</span></span>",this._createReplyBtn(t.rcount),'<div class="operation more-operation"><div class="spot"></div><div class="opera-list"><ul>'+(this._canSetTop(t)?'<li class="set-top">'+(t.isUpTop?"取消置顶":"设为置顶")+"</li>":"")+(this._canBlackList(t.mid)?'<li class="blacklist">加入黑名单</li>':"")+(this._canReport(t.mid)?'<li class="report">举报</li>':"")+(this._canDel(t.mid)&&!t.isTop?'<li class="del" data-mid="'+t.mid+'">删除</li>':"")+"</ul></div></div>","</div>","</div>"].join("");return u.browser.version.mobile&&(i=['<div class="con">','<div class="user">'+this._identity(t.mid,t.assist,t.member.fans_detail),'<a data-usercard-mid="'+t.mid+'" href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.mid+'" target="_blank" class="name '+this._createVipClass(t.member.vip.vipType,t.member.vip.vipStatus,t.member.vip.themeType)+'">'+u.unhtml(t.member.uname)+'</a><a class="level-link" href="//web.archive.org/web/20201122165301/https://www.bilibili.com/blackboard/help.html#%E4%BC%9A%E5%91%98%E7%AD%89%E7%BA%A7%E7%9B%B8%E5%85%B3" target="_blank"><i class="level l'+t.member.level_info.current_level+'"></i></a>'+this._createNameplate(t.member.nameplate),'<div class="right">','<span class="time">'+this._formateMobileTime(t.ctime)+"</span></div>","</div>",this._createMsgContent(t),'<div class="info">',this._createPlatformDom(t.content.plat),'<span class="like '+(1==t.action?"liked":"")+'"><i></i><span>'+(t.like||"")+"</span></span>",this._createReplyBtn(t.rcount),'<div class="operation more-operation"><div class="spot"></div><div class="opera-list"><ul>'+(this._canSetTop(t)?'<li class="set-top">'+(t.isUpTop?"取消置顶":"设为置顶")+"</li>":"")+(this._canBlackList(t.mid)?'<li class="blacklist">加入黑名单</li>':"")+(this._canReport(t.mid)?'<li class="report">举报</li>':"")+(this._canDel(t.mid)&&!t.isTop?'<li class="del" data-mid="'+t.mid+'">删除</li>':"")+"</ul></div></div>","</div>","</div>"].join("")),t.state===this.blacklistCode?e:i},b.prototype._createTopFoldedListCon=function(t){var e=this._parentBlacklistDom(t,0),i=['<div class="con">','<div class="user">'+this._identity(t.mid,t.assist,t.member.fans_detail),'<a data-usercard-mid="'+t.mid+'" href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.mid+'" target="_blank" class="name '+this._createVipClass(t.member.vip.vipType,t.member.vip.vipStatus,t.member.vip.themeType)+'">'+u.unhtml(t.member.uname)+'</a><a class="level-link" href="//web.archive.org/web/20201122165301/https://www.bilibili.com/blackboard/help.html#%E4%BC%9A%E5%91%98%E7%AD%89%E7%BA%A7%E7%9B%B8%E5%85%B3" target="_blank"><i class="level l'+t.member.level_info.current_level+'"></i></a>'+this._createNameplate(t.member.nameplate),"</div>",this._createMsgContent(t),'<div class="info">',t.floor?'<span class="floor">#'+t.floor+"</span>":"",this._createPlatformDom(t.content.plat),'<span class="time">'+this._formateTime(t.ctime)+"</span>",'<span class="like '+(1==t.action?"liked":"")+'"><i></i><span>'+(t.like||"")+"</span></span>",'<span class="hate '+(2==t.action?"hated":"")+'"><i></i></span>',this._createReplyBtn(t.rcount),'<div class="operation more-operation"><div class="spot"></div><div class="opera-list"><ul>'+(this._canSetTop(t)?'<li class="set-top">'+(t.isUpTop?"取消置顶":"设为置顶")+"</li>":"")+(this._canBlackList(t.mid)?'<li class="blacklist">加入黑名单</li>':"")+(this._canReport(t.mid)?'<li class="report">举报</li>':"")+(this._canDel(t.mid)&&!t.isTop?'<li class="del" data-mid="'+t.mid+'">删除</li>':"")+"</ul></div></div>","</div>","</div>"].join("");return u.browser.version.mobile&&(i=['<div class="con">','<div class="user">'+this._identity(t.mid,t.assist,t.member.fans_detail),'<a data-usercard-mid="'+t.mid+'" href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.mid+'" target="_blank" class="name '+this._createVipClass(t.member.vip.vipType,t.member.vip.vipStatus,t.member.vip.themeType)+'">'+u.unhtml(t.member.uname)+'</a><a class="level-link" href="//web.archive.org/web/20201122165301/https://www.bilibili.com/blackboard/help.html#%E4%BC%9A%E5%91%98%E7%AD%89%E7%BA%A7%E7%9B%B8%E5%85%B3" target="_blank"><i class="level l'+t.member.level_info.current_level+'"></i></a>'+this._createNameplate(t.member.nameplate),'<div class="right">',t.floor?'<span class="floor">#'+t.floor+"</span>":"",'<span class="time">'+this._formateMobileTime(t.ctime)+"</span></div>","</div>",this._createMsgContent(t),'<div class="info">',this._createPlatformDom(t.content.plat),'<span class="like '+(1==t.action?"liked":"")+'"><i></i><span>'+(t.like||"")+"</span></span>",'<span class="hate '+(2==t.action?"hated":"")+'"><i></i></span>',this._createReplyBtn(t.rcount),'<div class="operation more-operation"><div class="spot"></div><div class="opera-list"><ul>'+(this._canSetTop(t)?'<li class="set-top">'+(t.isUpTop?"取消置顶":"设为置顶")+"</li>":"")+(this._canBlackList(t.mid)?'<li class="blacklist">加入黑名单</li>':"")+(this._canReport(t.mid)?'<li class="report">举报</li>':"")+(this._canDel(t.mid)&&!t.isTop?'<li class="del" data-mid="'+t.mid+'">删除</li>':"")+"</ul></div></div>","</div>","</div>"].join("")),t.state===this.blacklistCode?e:i},b.prototype._createMsgContent=function(t){var e,i;return-1===[3,4].indexOf(t.state)||t.content.lottery?(e=t.content.message.replace(/&amp;/g,"&"),i=this._resolveJump(e,t.content.jump_url||{}),e=this._resolveUrl(i),i=this._formateMemberMap(t.content.members||[]),i=this._resolveAt(e,i),i=this._resolveEmoji(i,t.content.emote||{}),i=this._resolveSeek(i),i=this._resolveVote(i,t.content),i=this._resolveLottery(i,t.content),'<p class="text">'+(t.isTop||t.isUpTop?'<span class="stick">置顶</span>':"")+i+"</p>"):'<p><a href="javascript:;">***</a></p>'},b.prototype._createVoteContent=function(t){return t.vote&&t.vote.id&&!t.lottery?(t.vote.title=u.unhtml(t.vote.title),['<div class="vote-container" data-id="'+t.vote.id+'" data-name="'+t.vote.title+'">','<div class="image-area">','<div class="share-img"></div>',"</div>",'<div class="text-area">','<div class="text-content">'+t.vote.title+"</div>",'<div class="text-desc">'+t.vote.cnt+"人参与</div>",'<div class="vote-btn-box">','<div class="vote-btn">投票</div>',"</div>","</div>","</div>"].join("")):""},b.prototype._createLotteryContent=function(t){if(t.lottery&&t.lottery.lottery_id){t.lottery.title=u.unhtml(t.lottery.title);(new Date).getTime();var e=2===t.lottery.lottery_status?"活动已结束":u.formatLotteryTime(t.lottery.lottery_time);return['<div class="lottery-container" data-id="'+t.lottery.lottery_id+'">','<div class="image-area">','<div class="share-img"></div>',"</div>",'<div class="text-area">','<div class="text-content">评论抽奖</div>','<div class="text-desc">'+e+"</div>",2===t.lottery.lottery_status?'<div class="lottery-btn-box"><div class="lottery-btn">查看结果</div></div>':"","</div>","</div>"].join("")}return""},b.prototype._canSetTop=function(t){return!!this.userStatus.isLogin&&(+this.upId==+this.userStatus.mid&&(!t.lottery_id&&!t.isTop))},b.prototype._canReport=function(t){return+t!=+this.userStatus.mid},b.prototype._canBlackList=function(t){return+t!=+this.userStatus.mid},b.prototype._identity=function(t,e,i){if(+this.upId===t)return'<span class="stick assist">UP</span>';if(e)return'<span class="stick assist">骑士</span>';if(i){e=["#2EBDA7","#5896DE","#A068F1","#FF86B2","#F68D18","#4D978C","#5C70B2","#7864DA","#B74C77","#FA8511"][Math.ceil(i.level/4)-1];return'<span class="stick true-love" style="border-color:'+e+";color:"+e+'">'+i.medal_name+'<span class="medal-level" style="border-color:'+e+'">'+i.level+"</span></span>"}return""},b.prototype._canDel=function(t){return!!this.userStatus.isLogin&&(+this.upId==+this.userStatus.mid||+this.userStatus.mid==+t||this.assist)},b.prototype._createReplyBtn=function(t){return 0<t?'<span class="reply btn-hover btn-highlight">回复</span>':'<span class="reply btn-hover">回复</span>'},b.prototype._createTags=function(t){var e=t.up_action&&t.up_action.like,t=t.label&&t.label.content;return e||t?['<div class="reply-tags">',e?"<span>UP主觉得很赞</span>":"",t?"<span>"+t+"</span>":"","</div>"].join(""):""},b.prototype._createNameplate=function(t){return t.image_small?'<div class="nameplate"><a class="nameplate-icon"'+(u.browser.version.mobile?"":'href="https://web.archive.org/web/20201122165301/https://account.bilibili.com/site/nameplate.html" target="_blank"')+'><img src="'+u.trimHttp(u.webp(t.image_small,{w:32,h:32}))+'"></a><div class="nameplate-card"><i class="nameplate-arrow"></i><img class="nameplate-pic" src="'+u.trimHttp(u.webp(t.image,{w:62,h:62}))+'"><div class="nameplate-text"><p class="n-name">'+t.name+'</p><p class="n-title" title="'+t.condition+'">'+t.condition+'</p><p class="n-type"><span>'+t.level+'</span><a href="https://web.archive.org/web/20201122165301/https://account.bilibili.com/site/nameplate.html" target="_blank">查看全部>></a></p></div></div></div>':""},b.prototype._createUserSailing=function(t){if(!t.cardbg)return"";var e,i=t.cardbg,o="";return"suit"===i.type&&(t=(e=i.fan.number).toString(),e<1e5&&(t="0".repeat(6-t.length)+t),o='<div class="sailing-info" style="color:'+i.fan.color+'">NO.<br>'+t+"</div>"),'<div class="sailing"><img class="sailing-img" src="'+u.trimHttp(u.webp(i.image,{w:576,h:96}))+'" alt="'+i.name+'"/>'+o+"</div>"},b.prototype._createPlatformDom=function(t){var e="";return 2===t?e="安卓客户端":3===t?e="iOS客户端":4===t&&(e="Windows Phone客户端"),e&&'<span class="plad">来自<a href="//web.archive.org/web/20201122165301/https://app.bilibili.com/" target="_blank">'+e+"</a></span>"},b.prototype._checkId=function(t,e){for(var i=0,o=t.length;i<o;++i)if(+t[i].rpid==+e)return!0;return!1},b.prototype._createSubReplyList=function(t,e,i,o,a,s){var n="";if(t=t||[],0===e)return n;for(var r=!!this.jumpId&&this._checkId(t,this.jumpId),l=i||r?t.length:Math.min(t.length,3),c=0;c<l;++c){var d=t[c],p=this._createSubReplyItem(d,c),m=this._subBlacklistDom(d);n+=d.state===this.blacklistCode?m:p}return(s||e<=t.length)&&a&&!u.browser.version.mobile&&(n+='<div class="sub-reply-fold-tip"><a class="view-sub-fold" data-root="'+o+'">查看被折叠的回复</a><a href="'+this.folder.rule+'" class="fold-rule" target="_blank">（折叠规则）</a></div>'),!i&&!r&&e>t.length&&(n+='<div class="view-more">共<b>'+e+'</b>条回复, <a class="btn-more" data-pid="'+o+'" data-fold="'+a+'">点击查看</a></div>'),n},b.prototype._createSubReplyItem=function(t,e){var i=['<div class="reply-item reply-wrap" data-id="'+t.rpid+'" data-index="'+e+'">','<a href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.mid+'" data-usercard-mid="'+t.mid+'" target="_blank" class="reply-face">','<img src="'+u.trimHttp(u.webp(t.member.avatar,{w:52,h:52}))+'" alt="">',"</a>",'<div class="reply-con">','<div class="user">','<a href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.mid+'" target="_blank" data-usercard-mid="'+t.mid+'" class="name '+this._createVipClass(t.member.vip.vipType,t.member.vip.vipStatus,t.member.vip.themeType)+'">'+u.unhtml(t.member.uname)+"</a>",'<a class="level-link" href="//web.archive.org/web/20201122165301/https://www.bilibili.com/blackboard/help.html#%E4%BC%9A%E5%91%98%E7%AD%89%E7%BA%A7%E7%9B%B8%E5%85%B3" target="_blank"><i class="level l'+t.member.level_info.current_level+'"></i></a>',this._createSubMsgContent(t),"</div>","</div>",'<div class="info">','<span class="time">'+this._formateTime(t.ctime)+"</span>",'<span class="like '+(1==t.action?"liked":"")+'"><i></i><span>'+(t.like||"")+"</span></span>",'<span class="hate '+(2==t.action?"hated":"")+'"><i></i></span>','<span class="reply btn-hover">回复</span>','<div class="operation btn-hover btn-hide-re"><div class="spot"></div><div class="opera-list"><ul>'+(this._canBlackList(t.mid)?'<li class="blacklist">加入黑名单</li>':"")+(this._canReport(t.mid)?'<li class="report">举报</li>':"")+(this._canDel(t.mid)?'<li class="del" data-mid="'+t.mid+'">删除</li>':"")+"</ul></div></div>","</div>","</div>"].join("");return u.browser.version.mobile&&(i=['<div class="reply-item reply-wrap" data-id="'+t.rpid+'" data-index="'+e+'">','<div class="reply-con">','<div class="user">','<a href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.mid+'" target="_blank" data-usercard-mid="'+t.mid+'" class="name '+this._createVipClass(t.member.vip.vipType,t.member.vip.vipStatus,t.member.vip.themeType)+'">'+u.unhtml(t.member.uname)+"</a>",'<a class="level-link" href="//web.archive.org/web/20201122165301/https://www.bilibili.com/blackboard/help.html#%E4%BC%9A%E5%91%98%E7%AD%89%E7%BA%A7%E7%9B%B8%E5%85%B3" target="_blank"><i class="level l'+t.member.level_info.current_level+'"></i>','<div class="right"><span class="time">'+this._formateMobileTime(t.ctime)+"</span></div>","</a>",this._createSubMsgContent(t),"</div>",'<div class="info">','<span class="like '+(1==t.action?"liked":"")+'"><i></i><span>'+(t.like||"")+"</span></span>",'<span class="reply btn-hover">回复</span>','<div class="operation btn-hover btn-hide-re"><div class="spot"></div><div class="opera-list"><ul>'+(this._canBlackList(t.mid)?'<li class="blacklist">加入黑名单</li>':"")+(this._canReport(t.mid)?'<li class="report">举报</li>':"")+(this._canDel(t.mid)?'<li class="del" data-mid="'+t.mid+'">删除</li>':"")+"</ul></div></div>","</div>","</div>","</div>"].join("")),i},b.prototype._createSubMsgContent=function(t){var e,i;return-1!==[3,4].indexOf(t.state)?'<a href="javascript:;">***</a>':(e=t.content.message.replace(/&amp;/g,"&"),i=this._resolveJump(e,t.content.jump_url||{}),e=this._resolveUrl(i),i=this._formateMemberMap(t.content.members||[]),i=this._resolveAt(e,i),t=this._resolveEmoji(i,t.content.emote||{}),'<span class="text-con">'+this._resolveSeek(t)+"</span>")},b.prototype._formateTime=function(t){if(!+t)return t;var e=Math.floor((new Date).getTime()/1e3),i=new Date;if(i.setHours(0),i.setMinutes(0),i.setSeconds(0),(i=Math.floor(i.getTime()/1e3))<t&&0<=e-t){if(e-t<=50){var o=10*Math.floor((e-t)%60/10);return(10<t?o:10)+"秒前"}return e-t<3600?Math.floor((e-t)/60)+"分钟前":Math.floor((e-t)/3600)+"小时前"}var a=new Date;a.setTime(1e3*t);i=a.getMonth()+1,o=a.getDate(),e=a.getHours(),t=a.getMinutes();return i<10&&(i="0"+i),o<10&&(o="0"+o),e<10&&(e="0"+e),t<10&&(t="0"+t),a.getFullYear()+"-"+i+"-"+o+" "+e+":"+t},b.prototype._formateMobileTime=function(t){if(!+t)return t;var e=Math.floor((new Date).getTime()/1e3);if(0<=e-t){if(e-t<=50){var i=10*Math.floor((e-t)%60/10);return(10<t?i:10)+"秒前"}return e-t<3600?Math.floor((e-t)/60)+"分钟前":e-t<86400?Math.floor((e-t)/3600)+"小时前":e-t<2592e3?Math.floor((e-t)/3600/24)+"天前":e-t<31536e3?Math.floor((e-t)/3600/24/30)+"月前":Math.floor((e-t)/3600/24/365)+"年前"}},b.prototype._getReplyByPage=function(t){return $.ajax({url:m.reply,data:{jsonp:"jsonp",pn:t,type:this.pageType,oid:this.oid,sort:this.sort},dataType:"jsonp"})},b.prototype._getSubReplyByPage=function(t,e){return $.ajax({url:m.subReply,data:{jsonp:"jsonp",pn:e,type:this.pageType,oid:this.oid,ps:10,root:t},dataType:"jsonp"})},b.prototype._getFoldedReply=function(t){var e={oid:this.oid,type:this.pageType,jsonp:"jsonp"};return t&&(e.next=t),$.ajax({url:m.folded,data:e,dataType:"jsonp"})},b.prototype._getSubFoldedReply=function(t,e){t={oid:this.oid,type:this.pageType,root:t,jsonp:"jsonp"};return e&&(t.next=e),$.ajax({url:m.replyFolded,data:t,dataType:"jsonp"})},b.prototype._createVipClass=function(t,e,i){return 1===i&&2===t?"vip-green-name":2===t&&1===e?"vip-red-name":""},b.prototype._sendMsg=function(e,t,i){var o=this,a=$(e).find(".comment-submit"),s=$(e).find("textarea"),n=this.isSubReply;new RegExp(/\[[^\]]+_[^\]]+\]/g);if(0===t.msg.replace(/(^\s*)|(\s*$)/g,"").length)return(new h).show(a,"你还没有评论！",2e3,"error"),s.focus().parent().addClass("error"),!1;s.parent().removeClass("error"),a.text("发送中").addClass("disabled"),o.timer=setTimeout(function(){clearTimeout(o.timer),a.text("发表评论").removeClass("disabled"),(new h).show(e,"当前网速不太给力哦，请尝试重新提交~",2e3,"info")},5e3);var r=String(t.msg).replace(/\　{5,}/g,"　　　").replace(/\n{3,}/g,"\n\n\n")||t.msg,l=(n?this.atMsg:"")+r,c={oid:this.oid,type:this.pageType,root:t.rid,parent:t.pid,message:l,plat:t.plat,code:t.code,ordering:2===this.sort?"heat":"time",jsonp:"jsonp"};$.ajax({url:m.add,type:"POST",data:c,dataType:"json",xhrFields:{withCredentials:!0},success:function(t){t&&0===t.code?(s.val(""),i&&0===t.data.success_action&&i(t.data.rpid,t.data.reply),(new h).show(a,t.data.success_toast||"发送成功",2e3),o._removeCaptcha(),o.dynamicRepost&&o.$root.find(".dynamic-repost-checkbox")[0].checked&&o.trigger("dynamicRepost",l,o.oid,o.userStatus.mid)):12041===t.code?o._blackroomExamFB():61001===t.code||61002===t.code?$.getScript("//web.archive.org/web/20201122165301/https://static.hdslb.com/common/js/identityDialog.js",function(){IdentityDialog(t.code,t.message)}):t&&(new h).show(a,t.message||"操作失败",2e3,"error"),t&&t.data&&t.data.need_captcha?o._renderCaptcha(e,t.data.url):o._removeCaptcha(),o.trigger("commentSent",c,t),clearTimeout(o.timer),a.text("发表评论").removeClass("disabled")}})},b.prototype._renderCaptcha=function(t,e){e='<div class="comment-captcha"><span>验证码：</span><input type="text" class="b-input" size="6" /><img src="'+u.trimHttp(e)+'"/></div>';t.find(".comment-captcha").remove(),t.append(e)},b.prototype._removeCaptcha=function(){$(".comment-captcha").remove()},b.prototype._reportFB=function(t,s,n,r){var l=this,e=['<div class="comment-bilibili-mask comment-report-bilibili-mask" style="height:'+$(document).height()+'px;">','<div class="comment-bilibili-con comment-report-bilibili">','<div class="t">请选择举报理由<i class="btn-close"></i></div>','<div class="con">','<div class="reason-box"></div>','<div class="other">','<p class="btn-other"><input type="radio" name="reason" id="other" value="0" /><label for="other">其他</label></p>','<div class="ta"><textarea placeholder="自定义理由" value=""></textarea></div></div>','<div class="btn"><a class="btn-cancel">取消</a><a class="btn-submit">确定</a><div>',"</div></div></div>"].join("");$(".comment-report-bilibili-mask").remove(),$("body").append(e);for(var i=[{type:"违反法律法规",list:[{name:"违法违规",reason:9},{name:"色情",reason:2},{name:"低俗",reason:10},{name:"赌博诈骗",reason:12}]},{type:"侵犯个人权益",list:[{name:"人身攻击",reason:7},{name:"侵犯隐私",reason:15}]},{type:"有害社区环境",list:[{name:"垃圾广告",reason:1},{name:"引战",reason:4},{name:"剧透",reason:5},{name:"刷屏",reason:3},{name:"抢楼",reason:16},{name:"内容不相关",reason:8},{name:"青少年不良信息",reason:17}]}],e=$(".comment-report-bilibili .reason-box"),o="",a=0,c=0;c<i.length;c++){o+='<dl class="clearfix"><dt>'+i[c].type+"</dt>";for(var d=0;d<i[c].list.length;d++)o+='<dd><input type="radio" name="reason" id="r'+a+'" value="'+i[c].list[d].reason+'" /><label for="r'+a+'">'+i[c].list[d].name+"</label></dd>",a++;o+="</dl>"}function p(t,e,i){var o=this,a={oid:s,type:n,rpid:r,reason:t,content:e,ordering:2===l.sort?"heat":"time",jsonp:"jsonp"};$.ajax({url:m.report,type:"post",data:a,xhrFields:{withCredentials:!0}}).done(function(t){0===t.code?((new h).show(i,"举报成功",1e3,"info"),$(".comment-report-bilibili-mask").remove()):12019==t.code?(new h).show(i,"举报过于频繁，请"+t.data.ttl+"秒后重试",1e3,"error"):(new h).show(i,t.message||"提交失败，请重试",1e3,"info"),o.trigger("report",a,t)})}return e.append(o),$(".comment-report-bilibili").off("click.comment-report-close").on("click.comment-report-close",".btn-close,.btn-cancel",function(t){$(".comment-report-bilibili-mask").remove()}),$(".comment-report-bilibili").off("click.comment-report-label").on("click.comment-report-label","label",function(t){"other"===$(this).attr("for")?$(".comment-report-bilibili").find(".ta").show(200):$(".comment-report-bilibili").find(".ta").hide(200)}),$(".comment-report-bilibili").off("click.comment-report-submit").on("click.comment-report-submit",".btn-submit",function(t){var e=$(".comment-report-bilibili").find('input[type="radio"]:checked').val(),i=$(".comment-report-bilibili").find("textarea").val();e?"0"==e?i?2<=u.getByteLen(i)&&u.getByteLen(i)<=200?p(e,i,$(this)):(new h).show($(this),"自定义举报内容长度为2-200字符",1e3,"error"):(new h).show($(this),"请完善举报理由",1e3,"error"):p(e,i,$(this)):(new h).show($(this),"请选择举报理由",1e3,"error")}),!1},b.prototype._voteFB=function(t,e,i){e=['<div class="comment-bilibili-mask comment-vote-bilibili-mask" style="height:'+$(document).height()+'px;">','<div class="comment-bilibili-con comment-vote-bilibili">','<div class="t">'+i+'<i class="btn-close"></i></div>','<div class="con">','<div class="vote-iframe"><iframe src="//web.archive.org/web/20201122165301/https://t.bilibili.com/h5/dynamic/vote#/result?vote_id='+e+'&from=comment&isWeb=true" frameborder="0"></iframe></div>',"</div></div></div>"].join("");$(".comment-vote-bilibili-mask").remove(),$("body").append(e),$(".comment-vote-bilibili").off("click.comment-vote-close").on("click.comment-vote-close",".btn-close,.btn-cancel",function(t){$(".comment-vote-bilibili-mask").remove()})},b.prototype._lotteryFB=function(t,e){e=['<div class="comment-bilibili-mask comment-vote-bilibili-mask" style="height:'+$(document).height()+'px;">','<div class="comment-bilibili-con comment-vote-bilibili">','<div class="t">评论抽奖<i class="btn-close"></i></div>','<div class="con">','<div class="vote-iframe"><iframe src="//web.archive.org/web/20201122165301/https://t.bilibili.com/lottery/h5/index/#/result?lottery_id='+e+'" frameborder="0"></iframe></div>',"</div></div></div>"].join("");$(".comment-vote-bilibili-mask").remove(),$("body").append(e),$(".comment-vote-bilibili").off("click.comment-vote-close").on("click.comment-vote-close",".btn-close,.btn-cancel",function(t){$(".comment-vote-bilibili-mask").remove()})},b.prototype._blackListFB=function(n,r,t,l,c){var d=this,p=+this.upId==+this.userStatus.mid,e=p?"拉黑后，将取消我对他的关注<br>禁止该用户与我进行互动。本条评论也会被删除。":"拉黑该用户之后，将自动解除关注关系，并禁止他关注我<br>以及与我互动。",e=['<div class="comment-bilibili-mask comment-bilibili-blacklist" style="height:'+$(document).height()+'px;">','<div class="comment-bilibili-con">','<div class="con">','<div class="text">'+e+"</div>",'<div class="btn"><a class="btn-cancel blacklist-confirm">确认拉黑</a><a class="btn-submit blacklist-cancel">取消</a><div>',"</div></div></div>"].join("");$(".comment-bilibili-blacklist").remove(),$("body").append(e),$(".comment-bilibili-blacklist").off("click.comment-blacklist-close").on("click.comment-blacklist-close",".btn-close,.blacklist-cancel",function(t){$(".comment-bilibili-blacklist").remove()}),$(".comment-bilibili-blacklist").off("click.comment-blacklist-submit").on("click.comment-blacklist-submit",".blacklist-confirm",function(t){var s=this;f.addBlacklist(l,function(t){var e,i,o,a;0===t.code?(e="",c.hasClass("list-item")&&(i=c.data("index"),a=d.fbData[i],e='<div class="user-face"><img src="'+d.noface+'"></div>'+d._parentBlacklistDom(a,i,d._pos),c.html(e)),c.hasClass("reply-item")&&(i=c.parents(".list-item").data("index"),o=c.data("index"),a=d.fbData[i].replies[o],e=d._subBlacklistDom(a),$(e).insertAfter(c),c.remove()),p?d._delReply({id:r,type:"normal"}).done(function(t){0===t.code?((new h).show($(s),"加入黑名单成功"),$(c).remove()):(new h).show($(s),t.message||"操作失败"),d.trigger("delete",r,t),$(".comment-bilibili-blacklist").remove()}):((new h).show($(s),"加入黑名单成功",1e3,"info"),$(".comment-bilibili-blacklist").remove(),$(c).remove())):((new h).show(n,"加入黑名单失败",1e3,"info"),$(".comment-bilibili-blacklist").remove()),d.trigger("blackList",l,t)})})},b.prototype._interActionFB=function(o){var a=this,s=this.interactionStatus[o],t="确认"+(0===s?"selection"===o?"开启":"恢复":"selection"===o?"停止":"关闭"),t=['<div class="comment-bilibili-mask comment-bilibili-interaction" style="height:'+$(document).height()+'px;">','<div class="comment-bilibili-con">','<div class="con">','<div class="text">'+{reply:{0:"恢复评论后，用户可正常发表评论、参与评论互动，已有的评论也恢复正常展示。",1:"关闭评论将会禁止任何人在此评论区发表内容，且已有评论在关闭期间将不可见。"},selection:{0:"开启精选评论后，所有评论都需经过我的确认后再向所有用户展示。可前往PC端创作中心",1:"停止精选评论后，如有遗留未处理评论，可前往PC端创作中心"},dm:{0:"恢复弹幕后，用户可正常发表弹幕、参与弹幕互动，已有的弹幕也恢复正常展示。",1:"关闭弹幕将会禁止任何人在此视频中发表弹幕，且已有弹幕在关闭期间将不可见。"}}[o][s]+"</div>",'<div class="btn"><a class="btn-cancel interaction-confirm">'+t+'</a><a class="btn-submit interaction-cancel">取消</a><div>',"</div></div></div>"].join("");$(".comment-bilibili-interaction").remove(),$("body").append(t),$(".comment-bilibili-interaction").off("click.comment-interaction-close").on("click.comment-interaction-close",".btn-close,.interaction-cancel",function(t){$(".comment-bilibili-interaction").remove()}),$(".comment-bilibili-interaction").off("click.comment-interaction-submit").on("click.comment-interaction-submit",".interaction-confirm",function(t){var e,i=this;e="dm"===o?{type:1,aid:a.oid,state:s}:(e="selection"===o?1===s?2:1:1===s?3:4,{oid:a.oid,type:a.pageType,action:e}),u.customReport("interaction-submit",{type:o,status:s}),$.ajax({type:"post",url:"dm"===o?m.dmModify:m.interactionModify,dataType:"json",data:e,xhrFields:{withCredentials:!0}}).done(function(t){var e;0===t.code?(e=t.data||{},(new h).show(i,e.action_toast||"操作成功",1e3,"info"),e="selection"===o?s?"开启":"停止":s?"恢复":"关闭",a.$root.find({selection:".up_reply_selection",reply:".up_reply",dm:".up_dm"}[o]).text(e+{selection:"评论精选",reply:"评论",dm:"弹幕"}[o]),a.interactionStatus[o]=1-a.interactionStatus[o],"dm"===o&&window.player?setTimeout(function(){window.player.outActions({dmSwitch:1===a.interactionStatus.dm})},300):(a.firstLoad=!1,a.loadPage(1)),$(".comment-bilibili-interaction").remove()):(new h).show(i,t.message||"操作失败",1e3,"error")}).fail(function(){(new h).show(i,"操作失败",1e3,"error")})})},b.prototype._blackroomExamFB=function(t,e,i,o,a){var s=['<div class="comment-bilibili-mask comment-bilibili-blackexam" style="height:'+$(document).height()+'px;">','<div class="comment-bilibili-con">','<div class="t no-title"><i class="btn-close"></i></div>','<div class="con">','<div class="text">该账号处于封禁中，点击申请答题</div>','<div class="btn"><a class="btn-cancel">取消</a><a class="btn-submit" target="_blank" href="//web.archive.org/web/20201122165301/https://www.bilibili.com/blackroom/releaseexame.html">去答题</a><div>',"</div></div></div>"].join("");$("body").append(s),$(".comment-bilibili-blackexam").off("click.comment-blackexam-close").on("click.comment-blackexam-close",".btn-close,.btn-cancel,.btn-submit",function(t){$(".comment-bilibili-blackexam").remove()})},b.prototype._foldFB=function(o){var a=this;this._getFoldedReply(this.foldedNext).then(function(t){var e,i;0===t.code?(i=t.data,a.foldedNext=i.cursor.next,a.foldIsEnd=i.cursor.is_end,e="",i.replies.forEach(function(t){e+=a._createReplyItem(t,0)}),i=['<div class="comment-bilibili-mask comment-bilibili-fold'+(u.browser.version.mobile?"-h5":"")+'" style="height:'+$(document).height()+'px;">','<div class="comment-bilibili-con comment-fold-bilibili">','<div class="t">查看评论<i class="btn-close"></i></div>','<div class="comment-area"><div class="comment-list">',e,"</div></div>","</div>","</div>"].join(""),$("body").append(i).addClass("preventScroll"),a._registerEvent(".comment-bilibili-fold"),a.foldDialogIsOpen=!0,$(".comment-fold-bilibili").off("click.comment-fold-close").on("click.comment-fold-close",".btn-close",function(t){$(".comment-bilibili-fold").remove(),$("body").removeClass("preventScroll"),a.foldDialogIsOpen=!1,a.foldedNext=null}),a._fixEmojiPosition(),a._needLoadMoreFold()&&a._loadMoreFold(),$(".comment-bilibili-fold .comment-area").off("scroll").on("scroll",function(){a._needLoadMoreFold()&&!a.isLoadingFold&&a._loadMoreFold()})):(new h).show(o,t.message,2e3,"error")})},b.prototype._subFoldFB=function(o,a){var s=this;this._getSubFoldedReply(a,this.subFoldedNext).then(function(t){var i,e;0===t.code?(e=t.data,s.subFoldedNext=e.cursor.next,s.subFoldIsEnd=e.cursor.is_end,i="",i+=s._createTopFoldedReplyItem(s.foldedReply[a]),i+='<p class="sub-fold-tip">被折叠评论</p>',e.replies.forEach(function(t,e){i+=s._createSubFoldedReplyItem(t,0===e)}),e=['<div class="comment-bilibili-mask comment-bilibili-fold comment-bilibili-sub-fold'+(u.browser.version.mobile?"-h5":"")+'" style="height:'+$(document).height()+'px;">','<div class="comment-bilibili-con comment-sub-fold-bilibili">','<div class="t">查看评论<i class="btn-close"></i></div>','<div class="comment-area"><div class="comment-list">',i,"</div></div>","</div>","</div>"].join(""),$("body").append(e).addClass("preventScroll"),s._registerEvent(".comment-bilibili-fold"),s.subFoldDialogIsOpen=!0,$(".comment-sub-fold-bilibili").off("click.comment-sub-fold-close").on("click.comment-sub-fold-close",".btn-close",function(t){$(".comment-bilibili-sub-fold").remove(),$("body").removeClass("preventScroll"),s.subFoldDialogIsOpen=!1,s.subFoldedNext=null}),s._needLoadMoreSubFold()&&s._loadMoreSubFold(a),$(".comment-bilibili-fold .comment-area").off("scroll").on("scroll",function(){s._needLoadMoreSubFold()&&!s.isLoadingSubFold&&s._loadMoreSubFold(a)})):(new h).show(o,t.message,2e3,"error")})},b.prototype._needLoadMoreFold=function(){var t=$(".comment-fold-bilibili .comment-area"),e=$(".comment-fold-bilibili .comment-list"),i=t.height(),e=e.height(),t=t.scrollTop();return this.foldDialogIsOpen&&!this.foldIsEnd&&(e<=i+20||e<i+t+20)},b.prototype._loadMoreFold=function(){var i=this;i.isLoadingFold=!0,this._getFoldedReply(this.foldedNext).then(function(t){var e;0===t.code&&(t=t.data,i.foldedNext=t.cursor.next,i.foldIsEnd=t.cursor.is_end,e="",t.replies.forEach(function(t){e=i._createReplyItem(t,0),$(".comment-fold-bilibili .comment-list").append(e)}),i.isLoadingFold=!1,i._fixEmojiPosition(),i._needLoadMoreFold()&&i._loadMoreFold())}).fail(function(){i.isLoadingFold=!1})},b.prototype._needLoadMoreSubFold=function(){var t=$(".comment-sub-fold-bilibili .comment-area"),e=$(".comment-sub-fold-bilibili .comment-list"),i=t.height(),e=e.height(),t=t.scrollTop();return this.subFoldDialogIsOpen&&!this.subFoldIsEnd&&(e<=i+20||e<i+t+20)},b.prototype._loadMoreSubFold=function(t){var i=this;i.isLoadingSubFold=!0,this._getSubFoldedReply(t,this.subFoldedNext).then(function(t){var e;0===t.code&&(t=t.data,i.subFoldedNext=t.cursor.next,i.subFoldIsEnd=t.cursor.is_end,e="",t.replies.forEach(function(t){e=i._createSubFoldedReplyItem(t),$(".comment-sub-fold-bilibili .comment-list").append(e)}),i.isLoadingSubFold=!1,i._needLoadMoreSubFold()&&i._loadMoreSubFold())}).fail(function(){i.isLoadingSubFold=!1})},b.prototype._parentBlacklistDom=function(t,e,i){return['<div class="con '+(i==e?"no-border":"")+'">','<div class="user blacklist-font-color">黑名单用户</div>','<p class="text">由于黑名单设置，该评论已被隐藏。</p>','<div class="info">',t.floor?'<span class="floor">#'+t.floor+"</span>":"",this._createPlatformDom(t.content.plat),'<span class="time">'+this._formateTime(t.ctime)+"</span>",this._canDel(t.mid)?'<div class="operation btn-hover"><div class="spot"></div><div class="opera-list"><ul><li class="del" data-mid="'+t.mid+'">删除</li></ul></div></div>':"","</div>","</div>"].join("")},b.prototype._subBlacklistDom=function(t){return['<div class="reply-item reply-wrap" data-id="'+t.rpid+'">','<a class="reply-face"><img src="'+this.noface+'"></a>','<div class="reply-con">','<div class="user">','<span class="blacklist-font-color name">黑名单用户 </span> <span class="text-con">由于黑名单设置，该回复已被隐藏。</span>',"</div>","</div>",'<div class="info">','<span class="time">'+this._formateTime(t.ctime)+"</span>",this._canDel(t.mid)?'<div class="operation btn-hover btn-hide-re"><div class="spot"></div><div class="opera-list"><ul><li class="del" data-mid="'+t.mid+'">删除</li></ul></div></div>':"","</div>","</div>"].join("")},b.prototype._setTop=function(t,e){return $.ajax({type:"post",url:m.setTop,dataType:"json",data:{oid:this.oid,type:this.pageType,rpid:t,action:e,jsonp:"jsonp"},xhrFields:{withCredentials:!0}})},b.prototype._delReply=function(t){var e={lottery:m.lotteryDel,normal:m.del}[t.type],i={oid:this.oid,type:this.pageType,jsonp:"jsonp"};return i["lottery"===t.type?"lottery_id":"rpid"]=t.id,$.ajax({type:"POST",url:e,dataType:"json",data:i,xhrFields:{withCredentials:!0}})},b.prototype._likeReply=function(t,e){return $.ajax({type:"POST",url:m.like,dataType:"json",data:{oid:this.oid,type:this.pageType,rpid:t,action:e,ordering:2===this.sort?"heat":"time",jsonp:"jsonp"},xhrFields:{withCredentials:!0}})},b.prototype._hateReply=function(t,e){return $.ajax({type:"POST",url:m.hate,dataType:"json",data:{oid:this.oid,type:this.pageType,rpid:t,action:e,ordering:2===this.sort?"heat":"time",jsonp:"jsonp"},xhrFields:{withCredentials:!0}})},b.prototype._updateSubReplyByPage=function(o,a,s,n,r){var l=this;$.fn.paging||p(),this._getSubReplyByPage(o,a).done(function(t){var e,i;t&&0===t.code&&(i=(e=t.data.page).num*e.size>=e.count,s.find(".reply-box").html(l._createSubReplyList(t.data.replies,t.data.page.count,!0,o,r,i)),e=Math.ceil(t.data.page.count/t.data.page.size),i=s.find(".paging-box"),s.find(".reply-box").attr("data-page",a).attr("data-total",t.data.page.count),1<e?i.paging({pageCount:e,current:a,backFn:function(t){l.$root.trigger("subReplyPageChange",{pid:o,page:t,parent:s,hasFolded:r}),l.trigger("subReplyPageChange",{pid:o,page:t,parent:s,hasFolded:r})}}):s.find(".paging-box").html(""),l._fixEmojiPosition(),"function"==typeof n&&setTimeout(function(){n.call(null)},10))}).fail(function(){})},b.prototype._registerEvent=function(t){var l=this,e=this.$root;function i(){$(window).off("scroll.comment").on("scroll.comment",function(){var t=l.$root.find(".bb-comment > .comment-send"),e=l.$root.find(".bb-comment > .comment-header");!l._isInView(l.$root)||l.loaded||l.loading||(l._showLoading("<span>loading...</span>"),l.loadPage(1)),!l.noPage&&$(".comment-list").height()>$(window).height()&&(l._isInView(e,!0)?(t.insertAfter(e),l.sendPosition=1):l._isInView(l.$root.find(".bottom-page"),!0)&&(l.$root.find(".bb-comment").append(t),l.sendPosition=2))})}t&&(e=$(t)),e.off("click"),e.off("click.showMore").on("click.showMore",".btn-more",function(){var t=$(this).data("pid"),e=$(this).data("fold");l._updateSubReplyByPage(t,1,$(this).parents(".list-item:eq(0)"),null,e),u.customReport("replyCardCheckClick",{parentId:t})}),e.off("subReplyPageChange").on("subReplyPageChange",function(t,e){l._updateSubReplyByPage(e.pid,e.page,e.parent,null,e.hasFolded)}),e.off("replyPageChange").on("replyPageChange",function(t,e){l.loadPage(e.p,e.isBottom)}),e.on("click.openMiniLogin",".btn-open-mini-Login",function(){l.quickLogin()}),e.on("click.emoji",".comment-emoji",function(t){var e=$(this).siblings(".textarea-container").find("textarea"),i=$(this).offset().left-l.$root.offset().left,o=$(this).offset().top-l.$root.offset().top+$(this).outerHeight();$(this).parents(".comment-list").length;e.focus(),l.emoji?(l.emoji.show(e,i,o),$(".emoji-box").css("zIndex",10001)):l._getEmoji(e,i,o);o=$(this).prev().find(".comment-submit").data("rid");u.customReport("replyEmojiClick",{type:l.pageType,oid:l.oid,position:o?3:l.sendPosition}),t.stopPropagation()}),e.off("focus.textarea").on("focus.textarea","textarea",function(){$(this).parent().addClass("focus"),0===$(this).parents(".list-item").length&&(l.isSubReply=!1);var t=$(this).next().data("rid");u.customReport("replyInputClick",{type:l.pageType,oid:l.oid,position:t?3:l.sendPosition}),u.browser.version.mobile&&$(window).off("scroll.comment")}),$(window).off("resize.comment").on("resize.comment",function(){l._fixEmojiPosition()}),e.off("blur.textarea").on("blur.textarea","textarea",function(){$(this).parent().removeClass("focus"),u.browser.version.mobile&&i()}),e.off("input.textarea").on("input.textarea","textarea",function(){$(this).parent().removeClass("error")}),e.on("click.sendMsg",".comment-submit",function(){var i,o,a,s,t=$(this).parent(),e=$(this).siblings("textarea").val()||"",n=void 0,r=t.find(".comment-captcha");$(this).hasClass("disabled")||(0<r.length&&(n=r.find("input").val()),r=$(this).data("rid"),u.customReport("replySendClick",{type:l.pageType,oid:l.oid,position:r?3:l.sendPosition}),i={rid:$(this).attr("data-rid"),pid:$(this).attr("data-pid"),msg:e,plat:1,code:n},n=$(this).parents(".list-item:eq(0)"),o=n.find(".reply-box"),a=+n.find(".reply-box").attr("data-page")||1,s=+n.find(".reply-box").attr("data-total")||0,l._sendMsg(t,i,function(t,e){i.rid?a!==Math.ceil(s/10)&&0!==s||l._appendSubReplyToTop(e,o):l._appendReplyToTop(e)}))}),e.on("click.report",".report",function(){var t;l.userStatus.isLogin?(t=$(this).parents(".reply-wrap:eq(0)").data("id"))&&l._reportFB($(this),l.oid,l.pageType,t):l.quickLogin()}),e.on("click.up_reply_selection",".up_reply_selection",function(){l._interActionFB("selection")}),e.on("click.up_reply",".up_reply",function(){l._interActionFB("reply")}),e.on("click.up_dm",".up_dm",function(){l._interActionFB("dm")}),e.on("click.blacklist",".blacklist",function(){var t,e;l.userStatus.isLogin?(e=(t=$(this).parents(".reply-wrap:eq(0)")).find("[data-usercard-mid]:eq(0)").data("usercard-mid"))&&l._blackListFB($(this),l.oid,l.pageType,e,t):l.quickLogin()}),e.on("click.reply",".reply",function(){var t,e,i,o,a,s,n;l.readOnly?(new h).show($(this),"评论区已被冻结，禁止发送评论",2e3,"ok"):(t=$(this).parents(".list-item:eq(0)"),i="回复 @"+((e=(n=$(this).parents(".reply-wrap:eq(0)")).hasClass("reply-item"))?n.find(".user .name"):n.find(".user .name").eq(0)).text()+" :",l.isSubReply=e,l.atMsg="回复 @"+n.find(".user .name").text()+" :",o=t.attr("data-id"),a=n.attr("data-id"),s=!l.userStatus.isLogin||l.userStatus.level_info&&l.userStatus.level_info.current_level<2&&l.userStatus.mid!=l.upId&&1!=l.userStatus.vipStatus&&l.userStatus.official_verify&&-1==l.userStatus.official_verify.type,t.siblings(".list-item").removeClass("open-reply").find(".comment-send").remove(),t.hasClass("open-reply")?(n=(n=t.find(".comment-send .comment-submit")).attr("data-rid")!==n.attr("data-pid"),e||n?s||t.find(".comment-send textarea").focus().prop("placeholder",i).val(""):(t.find(".comment-send").remove(),t.removeClass("open-reply"))):(t.find(".con").append(l._createReplyBox({isSub:!0})),t.addClass("open-reply"),s||t.find(".comment-send textarea").focus().prop("placeholder",i).val("")),t.find(".comment-send button.comment-submit").attr("data-rid",o).attr("data-pid",a),u.customReport("replyCardReplyClick",{rpid:o}))}),e.on("click",".follow-btn",function(){var i,o;l.userStatus.isLogin?(i=$(this),o=$('.follow-btn[data-mid="'+i.data("mid")+'"]'),i.hasClass("followed")?f.unFollow(i.data("mid"),function(t){var e;0===t.code?(e={type:9,aid:l.oid,follow:!1},u.customReport("follow_click",e),l.trigger("follow",e),o.removeClass("followed").text("关注"),(new h).show(i,"取消关注成功!",500,"ok")):(new h).show(i,t.message,500,"error")},i.attr("quiet"),122):f.follow(i.data("mid"),function(t){var e;22006!=t.code?0===t.code?(e={type:9,aid:l.oid,follow:!0},u.customReport("follow_click",e),l.trigger("follow",e),o.addClass("followed").text("已关注")):(new h).show(i,t.message,500,"error"):$.getScript("//web.archive.org/web/20201122165301/https://static.hdslb.com/plugins/attentionLimitPopup/attentionLimitPopup.js",function(){new attentionLimitPopup})},122)):u.browser.version.mobile?location.href="//web.archive.org/web/20201122165301/https://passport.bilibili.com/login":$.getScript("//web.archive.org/web/20201122165301/https://static.hdslb.com/account/bili_quick_login.js",function(){window.biliQuickLogin(function(t){window.location.reload()})})}),e.on("click.delete",".del",function(){var e=$(this).parents(".reply-wrap:eq(0)"),i=+e.attr("data-id"),t=e.attr("data-lottery-id"),o=e.hasClass("list-item")?"删除评论后，评论下所有回复都会被删除":"删除评论后将不可恢复",a=$(this),s=a.attr("data-mid"),n=l.userStatus.mid==l.upId&&s!=l.upId;(new h).show(a,"<p>"+o+"</p><p>是否继续？</p>","button",function(){l._reportEvent(n?"upmaster_deletecomment":"user_deletecomment"),l._delReply({id:t||i,type:t?"lottery":"normal"}).done(function(t){0===t.code?((new h).show(e,"删除成功"),e.remove()):(new h).show(e,t.message||"操作失败"),l.trigger("delete",i,t)})})}),e.on("click.set-top",".set-top",function(){var e=$(this).parents(".list-item:eq(0)"),i=+e.attr("data-id"),t=e.hasClass("is-top"),o=t?0:1,a=t?"取消成功":"置顶成功";l._setTop(i,o).done(function(t){t&&0===t.code?((new h).show(e,a),l.loadPage(1)):(new h).show(e,t.message||"操作失败"),l.trigger("setTop",{rid:i,action:o},t)}),l._reportEvent(t?"upmaster_cancelstick":"upmaster_stick")}),e.on("click.like",".like",function(){var i,o,a,s;l.userStatus.isLogin?(i=$(this),o=+$(this).parents(".reply-wrap:eq(0)").attr("data-id"),a=i.siblings(".hate"),s=i.hasClass("liked")?0:1,u.customReport("replyCardLikeClick",{rpid:o}),l._likeReply(o,s).then(function(t){var e;t&&0===t.code?0===s?(i.removeClass("liked"),e=+i.find("span").text()-1,i.find("span").text(0<e?e:"")):1===s&&(i.addClass("liked"),e=+i.find("span").text()+1,i.find("span").text(0<e?e:""),a.removeClass("hated")):(new h).show(i,t.message||"操作失败"),l.trigger("like",{rid:o,action:s},t)})):l.quickLogin()}),e.on("click.hate",".hate",function(){var i,o,a,s;l.userStatus.isLogin?(i=$(this),o=+$(this).parents(".reply-wrap:eq(0)").attr("data-id"),a=i.siblings(".like"),u.customReport("replyCardHateClick",{rpid:o}),s=i.hasClass("hated")?0:1,l._hateReply(o,s).then(function(t){var e;t&&0===t.code?0===s?i.removeClass("hated"):1===s&&(i.addClass("hated"),a.hasClass("liked")&&(a.removeClass("liked"),e=+a.find("span").text()-1,a.find("span").text(0<e?e:""))):(new h).show(i,t.message||"操作失败"),l.trigger("hate",{rid:o,action:s},t)})):l.quickLogin()}),e.on("click.operation",".spot",function(t){$(".opera-list").hide(),$(this).siblings(".opera-list").show(),t.stopPropagation(),$(this).hasClass("more-operation")&&(t=+$(this).parents(".reply-wrap:eq(0)").attr("data-id"),u.customReport("replyCardMoreClick",{rpid:t}))}),e.off("mouseleave.operation").on("mouseleave.operation",".opera-list",function(t){$(".opera-list").hide()}),e.on("click.tab",".tabs-order li",function(){var t=$(this);t.hasClass("on")||(t.addClass("on").siblings().removeClass("on"),l.sort=+t.attr("data-sort"),l.loadPage(1)),"0"==t.attr("data-sort")&&(u.videoReport("playpage_comment_allcomment"),u.customReport("replyOrderClick",{ordering:"time"})),"2"==t.attr("data-sort")&&(u.videoReport("playpage_comment_hotcomment"),u.customReport("replyOrderClick",{ordering:"heat"}))}),e.on("click.moreHot",".more-hot",function(){l.$root.find(".tabs-order li").removeClass("on"),l.$root.find('.tabs-order li[data-sort="2"]').addClass("on"),l.sort=2,l.loadPage(1,!0),l.trigger("loadMoreHot")}),e.on("click.reload",".reload-comment",function(){l._showLoading("<span>loading...</span>"),l.loadPage(1),l.trigger("reload")}),e.on("click.notice",".reply-notice",function(){u.customReport("playpage_anoun")}),e.on("click.deletNotice",".icon-close-notice",function(){var t=$(this).parent(),e=+t.attr("data-id");s&&+window.localStorage.getItem(n)<e&&window.localStorage.setItem(n,e),t.remove(),l._reportEvent("comment_notice_close"),u.customReport("playpage_anoun_delete"),l.trigger("closeNotice")}),i(),e.on("click.captcha",".comment-captcha > img",function(){var t=$(this).get(0),e=t.src.indexOf("&_ts=");t.src=t.src.substr(0,-1===e?t.src.length:e)+"&_ts="+Date.now()}),e.on("click.hide",".hidden-reply-toggle",function(){$(this).siblings(".quote").slideToggle(200)}),e.on("click.notice",".notice-item a",function(){l._reportEvent("comment_notice_click")}),e.on("click.vote",".vote-container, .vote-link",function(){var t,e;l.userStatus.isLogin?(t=$(this).data("id"),e=$(this).data("name"),u.browser.version.mobile&&(location.href="//web.archive.org/web/20201122165301/https://t.bilibili.com/h5/dynamic/vote#/result?vote_id="+t+"&from=comment"),t&&l._voteFB($(this),t,e)):l.quickLogin()}),e.on("click.lottery",".lottery-container, .lottery-link",function(){var t;l.userStatus.isLogin?(t=$(this).data("id"),u.browser.version.mobile&&(location.href="//web.archive.org/web/20201122165301/https://t.bilibili.com/lottery/h5/index/#/result?lottery_id="+t),t&&l._lotteryFB($(this),t)):l.quickLogin()}),e.on("click.space",".user-face a, .reply-face",function(){var t=$(this).data("usercard-mid");l.trigger("clickSpace",{type:"face",mid:t});t=+$(this).parents(".reply-wrap:eq(0)").attr("data-id");u.customReport("replyCardProfileClick",{rpid:t})}),e.on("click.space",".name",function(){var t=$(this).data("usercard-mid");l.trigger("clickSpace",{type:"name",mid:t});t=+$(this).parents(".reply-wrap:eq(0)").attr("data-id");u.customReport("replyCardNameClick",{rpid:t})}),e.on("click.level",".level-link",function(){var t=+$(this).parents(".reply-wrap:eq(0)").attr("data-id");u.customReport("replyCardLvClick",{rpid:t})}),e.on("click.moreLink",".more-link",function(){l.trigger("moreLinkClick")}),this.on("repostSuc",function(){l.$root.find(".dynamic-repost-checkbox")[0].checked=!1}),this.on("repostFail",function(t){var e=l.$root.find(".dynamic-repost"),t=t.data&&t.data.errmsg;(new h).show(e,t,2e3,"error")}),this.on("repostError",function(t){var e=l.$root.find(".dynamic-repost"),t=t.msg;(new h).show(e,t,2e3,"error")}),e.on("click.seek",".video-seek",function(){var t,e;window.commentAgent&&"function"==typeof window.commentAgent.seek&&(t=$(this).data("time"),(e=$(this).data("p"))<0?(window.commentAgent.seek(t),u.customReport("reply_timelink_click",{time:t})):(window.commentAgent.seek(t,e),u.customReport("reply_timelink_click",{time:t,p:e})),window.scrollTo(0,0))}),e.on("click.fold",".view-fold",function(){u.customReport("foldingreply-click",1),l._foldFB(this)}),e.on("click.fold",".view-sub-fold",function(){u.customReport("foldingreply-click",1);var t=$(this).data("root");l._subFoldFB(this,t)}),e.on("click.fold-rule",".fold-rule",function(){u.customReport("foldingreply-click",2)}),e.on("click.jump-url",".comment-jump-url",function(){var t=l.jumpReport[$(this).data("report")];u.customReport("reply_jumpUrl_click",encodeURIComponent(t))})},b.prototype._isInView=function(t,e){if(t.length){var i=$(window).height(),t=t.offset().top-$(window).scrollTop();return e?t<=i&&0<=t:t<=i}},b.prototype._showLoading=function(t){this.$root.find(".comment-loading").remove(),this.$root.find(".bb-comment").append('<div class="comment-loading">'+t+"</div>")},b.prototype._hideLoading=function(){this.$root.find(".comment-loading").remove()},b.prototype.jumpToReply=function(i){var o=this;this.jumpId=i,o.loading=!0,$.ajax({url:m.jump,dataType:"jsonp",data:{jsonp:"jsonp",rpid:i,oid:o.oid,type:o.pageType}}).done(function(t){var e;o._hideLoading(),o.loaded=!0,0===t.code?(o.mode=t.data.mode,o.blacklist=t.data.blacklist||0,o.assist=t.data.assist||0,o.pageInfo=t.data.page||{},(e=t.data.control)&&(o.control.bg_text=e.bg_text,o.control.child_input_text=e.child_input_text,o.control.input_disable=e.input_disable,o.control.root_input_text=e.root_input_text,o.control.web_selection=e.web_selection),o._renderTabs(t),o._renderNotice(t.data.notice),o._updateReplyListByData(t.data,o.pageInfo.num),o._renderBottomPagination(o.pageInfo),$(".common .b-head .results").html(t.data.page.acount||0).show(),t.data&&t.data.config&&t.data.config.showentry?$(".common .b-head .del-log").show():$(".common .b-head .del-log").remove(),o.$root.find(".bb-comment > .comment-send").remove(),$(o._createReplyBox()).insertBefore(o.$root.find(".comment-list")),o.jumpId="",setTimeout(function(){var t,e=$('[data-id="'+i+'"]');if(!e.length)return $(window).scrollTop(o.$root.offset().top),void(window.console&&window.console.log("[comment] dom not find when jump"));$(window).scrollTop(e.offset().top),e.hasClass("reply-item")?(t=e.parents(".list-item:eq(0)"),o._updateSubReplyByPage(+t.attr("data-id"),o.pageInfo.rt_num,t,function(){$('[data-id="'+i+'"]').find(".reply").click()})):e.hasClass("list-item")&&e.find(".con .reply").click()},100)):12002==t.code&&(o.$root.find(".bb-comment > .comment-send").remove(),$(o._createReplyBox({forbid:!0})).insertBefore(o.$root.find(".comment-list")))}).fail(function(){o.loaded||o._showLoading('<span>加载失败，<a class="reload-comment">点击重试</a></span>')}).always(function(){o.loading=!1})},b.prototype._showMessage=function(t,e){$("body").append('<div class="comment-msg"><span>'+t+"</span></div>"),setTimeout(function(){$(".comment-msg").remove()},e||2e3)},b.prototype._reportEvent=function(t,e){"function"==typeof window.rec_rp&&window.rec_rp("event",t,e)},b.prototype._appendReplyToTop=function(t){var e=$(this._createReplyItem(t,1)),i=this.$root.find(".comment-list .list-item:eq(0)");0<i.length?i.before(e):(this.$root.find(".no-more-reply").remove(),this.$root.find(".comment-list").append(e)),this.mounted&&((e=this.fbData).unshift(t),this.mounted(e))},b.prototype._appendSubReplyToTop=function(t,e){t=$(this._createSubReplyItem(t));e.prepend(t),this._fixEmojiPosition()},o.bbComment=b},function(t,e,i){i(9);var c=i(0);function o(t,e){this.container=t,this.data=e,this.currentSelect=0,this.curPage=1,this.totalPage=1,this.tabNum=5,this.tabWidth=58,this.avalEmojiNum=0,this.emojiData=[],this.showed=!1,this.emojiDom="<div class='emoji-box'><div class='emoji-title'><span></span></div><div class='emoji-wrap'></div><div class='emoji-notice'>想要使用更多表情包，请到app中进行设置</div><div class='emoji-tabs'><div class='emoji-container'><div class='emoji-tab-wrap clearfix'></div></div></div></div>"}o.prototype={init:function(){$(this.container).find(".emoji-box").remove(),$(this.container).append(this.emojiDom),this.emojiBox=$(this.container).find(".emoji-box"),this.hide();var t=$(this.container).find(".emoji-tabs"),e=$(this.container).find(".emoji-wrap"),i=$(this.container).find(".emoji-title"),s=this;this.emojiData=this.data,this.avalEmojiNum=this.data.length,this.createTabs(t),this.createEmoji(e,i,this.emojiData[0].pid),t.off("click.tab").on("click.tab",".tab-link",function(){s.currentSelect=+$(this).attr("data-index");var t=+$(this).data("pid");s.oldCurrentSelect=s.currentSelect,$(this).addClass("on").siblings(".tab-link").removeClass("on"),s.createEmoji(e,i,t)}),e.off("click").on("click",".emoji-list",function(t){var e=$(this).attr("data-emoji-text");s.insertAtCursor($(s.ta)[0],e);var i=$(this),o=i.data("pid"),a=i.data("id"),e=i.data("index"),i={};o?i={pid:o,id:a}:e&&(i={index:e}),c.customReport("emoji_click",i)}),$(document).off("click.offEmoji").on("click.offEmoji",function(t){s.emojiBox.is(t.target)||0!==s.emojiBox.has(t.target).length||s.emojiBox.hide()}),t.off("click.prev").on("click.prev",".prev",function(){1<s.curPage&&s.curPage--,s.updateTabSlide()}),t.off("click.next").on("click.next",".next",function(){s.curPage<s.totalPage&&s.curPage++,s.updateTabSlide()})},updateTabSlide:function(){var t=$(this.container).find(".emoji-tab-slider"),e=t.find(".prev"),t=t.find(".next");1<this.curPage?e.addClass("on"):e.removeClass("on"),this.curPage<this.totalPage?t.addClass("on"):t.removeClass("on"),$(this.container).find(".emoji-tab-wrap").css({left:-1*(this.curPage-1)*this.tabWidth*this.tabNum})},createTabs:function(t){var e="";this.totalPage=Math.ceil(this.avalEmojiNum/this.tabNum);for(var i=0;i<this.emojiData.length;i++)e+="<a class='tab-link "+(this.currentSelect==i?"on":"")+"' data-index='"+i+"' data-pid='"+this.emojiData[i].pid+"'><img src='"+c.trimHttp(c.webp(this.emojiData[i].purl,{w:88,h:88}))+"'></a>";t.find(".emoji-tab-wrap").html(e).css({width:this.emojiData.length*this.tabWidth,left:0}),t.find(".emoji-tab-slider").remove(),1<this.totalPage&&t.append('<div class="emoji-tab-slider clearfix"><span class="prev"></span><span class="next on"></span></div>')},createEmoji:function(t,e,i){e.find("span").text(this.emojiData[this.currentSelect].pname);var o=this.emojiData[this.currentSelect];if(4===o.type){for(var a="",s=0;s<o.emojis.length;s++)a+="<a class='emoji-list emoji-text emoji-default' data-emoji-text='"+o.emojis[s].name+"' data-index='"+s+"'>"+o.emojis[s].url+"</a>";t.html("").append(a)}else{for(var n,r,a="",l=o.emojis,s=0;s<l.length;s++)0==l[s].state&&(n="emoji-list emoji-text emoji-pic",l[s].size&&"s"===l[s].size&&(n+=" emoji-small"),r=l[s].id,a+="<a class='"+n+"' data-emoji-text='"+l[s].name+"' data-pid='"+i+"' data-id='"+r+"'><img src='"+c.trimHttp(c.webp(l[s].url,{w:112,h:112}))+"' title='"+l[s].name+"'></a>");t.html("").append(a)}},insertAtCursor:function(t,e){var i,o,a;document.selection?(t.focus(),sel=document.selection.createRange(),sel.text=e,sel.select()):t.selectionStart||"0"==t.selectionStart?(i=t.selectionStart,o=t.selectionEnd,a=t.scrollTop,t.value=t.value.substring(0,i)+e+t.value.substring(o,t.value.length),0<a&&(t.scrollTop=a),t.focus(),t.selectionStart=i+e.length,t.selectionEnd=i+e.length):(t.value+=e,t.focus())},show:function(t,e,i,o){this.showed||(this.init(),this.showed=!0),this.ta=t;var a=this;this.emojiBox.show().css({left:e,top:i});$(this.container).find(".emoji-tabs .tab-link"),$(this.container).find(".emoji-tab-slider");localStorage.getItem("emoji-notice-showed")||(localStorage.setItem("emoji-notice-showed",1),this.emojiBox.find(".emoji-notice").show(),setTimeout(function(){a.emojiBox.find(".emoji-notice").hide()},3e3))},hide:function(){this.emojiBox.hide()}},t.exports=o},function(t,e,i){i(16);var o=i(2),d=i(0),a=i(1),n={},r=new o,l=0;function s(t){d.browser.version.mobile||(this.userStatus=$.extend({isLogin:!1,vipStatus:0,vipType:0,mid:null},t),d.browser.version.mobile||this._registerEvent())}s.prototype.reset=function(t){this.userStatus=t,n={}},s.prototype._renderCard=function(t){$(".user-card").remove(),$("body").append(this._createCard(t)),d.videoReport("playpage_namecard2")},s.prototype._renderErrorCard=function(){$(".user-card").remove(),$("body").append(this._createErrorCard())},s.prototype._renderLoadingCard=function(){$(".user-card").remove(),$("body").append(this._createLoadingCard())},s.prototype._isLikeMe=function(t){if(t.card&&t.card.attentions)for(var e=0,i=t.card.attentions.length;e<i;++e)if(t.card.attentions[e]===this.userStatus.mid)return!0;return!1},s.prototype._createCard=function(t){var e=t.space.s_img||"//web.archive.org/web/20201122165301/https://i0.hdslb.com/bfs/static/c9dae917e24b4fc17c4d544caf6b6c0b17f8692b.jpg",i=0===t.card.official_verify.type?'<i title="个人认证" class="auth p-auth"></i>':"",o=1===t.card.official_verify.type?'<i title="企业/团体认证" class="auth o-auth"></i>':"",a="保密"===t.card.sex?"":"男"===t.card.sex?'<i class="sex men"></i>':'<i class="sex women"></i>',s=t.card.sign?'<p class="sign">'+d.unhtml(t.card.sign)+"</p>":"",n="",n=1===t.card.vip.theme_type&&2===t.card.vip.vipType?"vip-green-name":2===t.card.vip.vipType&&1===t.card.vip.vipStatus?"vip-red-name":"",r=this._isLikeMe(t),l=t.following?"已关注":"+关注",c=t.following?"liked":"";return c+=r?" liked-me":"",'<div class="user-card"><div class="bg" style="background-image:url('+d.trimHttp(d.webp(e,{w:750,h:240}))+')"></div><a target="_blank" href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.card.mid+'" class="face"><img src="'+d.trimHttp(d.webp(t.card.face,{w:50,h:50}))+'" />'+i+o+'</a><div class="info"><p class="user"><a target="_blank" href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.card.mid+'" class="name '+n+'">'+d.unhtml(t.card.name)+"</a>"+a+'<a href="//web.archive.org/web/20201122165301/https://www.bilibili.com/html/help.html#k_'+t.card.level_info.current_level+'" target="_blank"><i class="level l'+t.card.level_info.current_level+'"></i></a></p><p class="social"><a href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.card.mid+'/fans/follow" target="_blank">关注: <span class="like">'+t.card.friend+'</span></a><a href="//web.archive.org/web/20201122165301/https://space.bilibili.com/'+t.card.mid+'/fans/fans" target="_blank">粉丝: <span class="fans">'+d.formatNum(t.card.fans)+"</span></a></p>"+s+'</div><div class="btn-box"><a class="like '+c+'" mid="'+t.card.mid+'" uname="'+d.unhtml(t.card.name)+'"'+(t.quiet?' quiet="true"':"")+'><span class="default-text">'+l+'</span><span class="hover-text">取消关注</span></a><a href="//web.archive.org/web/20201122165301/https://message.bilibili.com/#whisper/mid'+t.card.mid+'" target="_blank" class="message">发消息</a></div></div>'},s.prototype._createErrorCard=function(){return'<div class="user-card"><p class="error-card">加载失败</p></div>'},s.prototype._createLoadingCard=function(){return'<div class="user-card"><p class="loading-card">正在加载中...请稍后。</p></div>'},s.prototype._setPosition=function(t){var e=$(t).offset().left,i=$(t).offset().top;$(t).outerWidth();i=$(t).offset().top<$(window).scrollTop()+$(".user-card").height()+32?i+$(t).outerHeight()+8:i-$(".user-card").height()-32,$(t.height),$(".user-card").css({left:e,top:i})},s.prototype._registerEvent=function(){var s=this;$("body").off("click.userCardAttention").on("click.userCardAttention",".user-card .btn-box .like",function(){var t,e,i;s.userStatus.isLogin?(t=$(this).hasClass("liked"),$(this).hasClass("liked-me"),e=$(this).attr("mid"),$(this).attr("uname"),i=this,t?(r.unFollow(e,function(t){t&&0===t.code?($(i).removeClass("liked").find(".default-text").text("+关注"),delete n[e],(new a).show($(i),"取消关注成功!",1e3,"ok")):t&&(new a).show($(i),t.message,1e3,"error")},$(this).attr("quiet")),d.videoReport("playpage_unfollow2")):(r.follow(e,function(t){22006==t.code?$.getScript("//web.archive.org/web/20201122165301/https://static.hdslb.com/plugins/attentionLimitPopup/attentionLimitPopup.js",function(){new attentionLimitPopup}):t&&0===t.code?($(i).text("取消关注").addClass("liked"),delete n[e]):t&&(new a).show($(i),t.message,1e3,"error")}),d.videoReport("playpage_follow2"))):document.location.href="https://web.archive.org/web/20201122165301/https://account.bilibili.com/login"}),$("body").on("mouseenter.data-userCard","[data-usercard-mid]",function(t){var o=$(this).attr("data-usercard-mid"),a=this;clearTimeout(l),l=setTimeout(function(){var t=+$(a).parents(".reply-wrap:eq(0)").attr("data-id"),e=$(a).parent().hasClass("user-face"),i=$(a).hasClass("name");e&&d.customReport("replyCardProfileHover",{rpid:t}),i&&d.customReport("replyCardNameHover",{rpid:t}),n[o]?(s._renderCard(n[o]),s._setPosition(a)):(s._renderLoadingCard(),s._setPosition(a),$.ajax({url:"//web.archive.org/web/20201122165301/https://api.bilibili.com/x/web-interface/card",dataType:"jsonp",data:{mid:o,photo:1,jsonp:"jsonp"},cache:!0,success:function(e){e&&0===e.code&&$.ajax({url:"//web.archive.org/web/20201122165301/https://api.bilibili.com/x/relation",data:{fid:o,jsonp:"jsonp"},dataType:"jsonp"}).done(function(t){t&&0===t.code?(e.data.following=1===t.data.attribute||2===t.data.attribute||6===t.data.attribute,e.data.quiet=1===t.data.attribute):e.data.following=!1,s._renderCard(e.data),s._setPosition(a),n[e.data.card.mid]=e.data}).fail(function(){s._renderErrorCard(),s._setPosition(a)})},error:function(){s._renderErrorCard(),s._setPosition(a)}}))},300)}),$("body").on("mouseleave.data-userCard","[data-usercard-mid]",function(t){clearTimeout(l),l=setTimeout(function(){$(".user-card").remove()},100)}),$("body").on("mouseenter.userCard",".user-card",function(t){clearTimeout(l)}),$("body").on("mouseleave.userCard",".user-card",function(t){$(".user-card").remove()})},t.exports=s},function(t,e,i){i(19);var o={init:function(t,e){return o.fillHtml(t,e),void o.bindEvent(t,e)},fillHtml:function(o,a){return function(){o.empty(),a.smallSize&&o.addClass("small"),pageOffset=a.smallSize?1:2,1<a.pageCount&&!a.jump&&o.append('<span class="result">共'+a.pageCount+"页</span>"),1<a.current?o.append('<a href="javascript:;" class="prev">上一页</a>'):(o.remove(".prev"),o.append('<span class="disabled">上一页</span>')),1!=a.current&&a.current>=pageOffset+2&&a.pageCount!=pageOffset+2&&o.append('<a href="javascript:;" class="tcd-number">1</a>'),2<a.current-pageOffset&&a.current<=a.pageCount&&a.pageCount>pageOffset+3&&o.append('<span class="dian">...</span>');var t,e=a.current-pageOffset,i=a.current+pageOffset;for((1<e&&a.current<pageOffset+2||1==a.current)&&i++,a.current>a.pageCount-(pageOffset+2)&&a.current>=a.pageCount&&e--;e<=i;e++)e<=a.pageCount&&1<=e&&(e!=a.current?o.append('<a href="javascript:;" class="tcd-number">'+e+"</a>"):o.append('<span class="current">'+e+"</span>"));a.current+pageOffset<a.pageCount-1&&1<=a.current&&a.pageCount>pageOffset+3&&o.append('<span class="dian">...</span>'),a.current!=a.pageCount&&a.current<a.pageCount-pageOffset&&a.pageCount!=pageOffset+2&&o.append('<a href="javascript:;" class="tcd-number">'+a.pageCount+"</a>"),a.current<a.pageCount?o.append('<a href="javascript:;" class="next">下一页</a>'):(o.remove(".next"),o.append('<span class="disabled">下一页</span>')),1<a.pageCount&&a.jump&&(t='<div class="page-jump">',a.smallSize||(t+="共<span>"+a.pageCount+"</span>页，"),t+='跳至<input type="text" />页</div>',o.append(t))}()},bindEvent:function(e,i){return e.off("click"),e.off("keydown"),e.on("click","a.tcd-number",function(){var t=parseInt($(this).text());o.fillHtml(e,{current:t,pageCount:i.pageCount,jump:i.jump}),"function"==typeof i.backFn&&i.backFn(t)}),e.on("click","a.prev",function(){var t=parseInt(e.children("span.current").text());o.fillHtml(e,{current:t-1,pageCount:i.pageCount,jump:i.jump}),"function"==typeof i.backFn&&i.backFn(t-1)}),e.on("click","a.next",function(){var t=parseInt(e.children("span.current").text());o.fillHtml(e,{current:t+1,pageCount:i.pageCount,jump:i.jump}),"function"==typeof i.backFn&&i.backFn(t+1)}),void e.on("keydown","input",function(t){13==t.keyCode&&(t=(t=Math.abs(parseInt($(this).val()))||1)>i.pageCount?i.pageCount:t,o.fillHtml(e,{current:t,pageCount:i.pageCount,jump:i.jump}),"function"==typeof i.backFn&&i.backFn(t))})}};t.exports=o},function(t,e){},,function(t,e){},,,,,,,function(t,e){},,,function(t,e){},function(t,e){}]);

}
/*
     FILE ARCHIVED ON 16:53:01 Nov 22, 2020 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 13:23:30 Sep 17, 2023.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  exclusion.robots: 0.105
  exclusion.robots.policy: 0.086
  cdx.remote: 0.136
  esindex: 0.009
  LoadShardBlock: 119.755 (6)
  PetaboxLoader3.datanode: 164.413 (8)
  load_resource: 200.295 (2)
  PetaboxLoader3.resolve: 83.262 (2)
*/